{"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\app.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\app.js","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":17},"end":{"line":2,"column":36}},"2":{"start":{"line":3,"column":12},"end":{"line":3,"column":21}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":34}},"4":{"start":{"line":5,"column":19},"end":{"line":5,"column":41}},"5":{"start":{"line":6,"column":21},"end":{"line":6,"column":45}},"6":{"start":{"line":7,"column":13},"end":{"line":7,"column":28}},"7":{"start":{"line":8,"column":13},"end":{"line":8,"column":28}},"8":{"start":{"line":9,"column":22},"end":{"line":9,"column":47}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"10":{"start":{"line":11,"column":19},"end":{"line":11,"column":49}},"11":{"start":{"line":12,"column":19},"end":{"line":12,"column":49}},"12":{"start":{"line":13,"column":19},"end":{"line":13,"column":49}},"13":{"start":{"line":14,"column":17},"end":{"line":14,"column":36}},"14":{"start":{"line":15,"column":16},"end":{"line":15,"column":42}},"15":{"start":{"line":16,"column":19},"end":{"line":16,"column":43}},"16":{"start":{"line":18,"column":21},"end":{"line":18,"column":156}},"17":{"start":{"line":19,"column":0},"end":{"line":30,"column":4}},"18":{"start":{"line":22,"column":4},"end":{"line":22,"column":45}},"19":{"start":{"line":22,"column":17},"end":{"line":22,"column":45}},"20":{"start":{"line":24,"column":4},"end":{"line":27,"column":5}},"21":{"start":{"line":25,"column":16},"end":{"line":25,"column":110}},"22":{"start":{"line":26,"column":6},"end":{"line":26,"column":45}},"23":{"start":{"line":28,"column":4},"end":{"line":28,"column":32}},"24":{"start":{"line":31,"column":0},"end":{"line":31,"column":27}},"25":{"start":{"line":32,"column":0},"end":{"line":32,"column":51}},"26":{"start":{"line":33,"column":0},"end":{"line":33,"column":24}},"27":{"start":{"line":34,"column":28},"end":{"line":34,"column":41}},"28":{"start":{"line":35,"column":0},"end":{"line":35,"column":33}},"29":{"start":{"line":36,"column":0},"end":{"line":36,"column":68}},"30":{"start":{"line":38,"column":0},"end":{"line":38,"column":31}},"31":{"start":{"line":39,"column":0},"end":{"line":39,"column":28}},"32":{"start":{"line":41,"column":0},"end":{"line":49,"column":1}},"33":{"start":{"line":42,"column":2},"end":{"line":44,"column":5}},"34":{"start":{"line":43,"column":4},"end":{"line":43,"column":43}},"35":{"start":{"line":46,"column":2},"end":{"line":48,"column":5}},"36":{"start":{"line":47,"column":4},"end":{"line":47,"column":35}},"37":{"start":{"line":50,"column":0},"end":{"line":50,"column":40}},"38":{"start":{"line":51,"column":0},"end":{"line":53,"column":3}},"39":{"start":{"line":52,"column":2},"end":{"line":52,"column":51}},"40":{"start":{"line":54,"column":0},"end":{"line":54,"column":25}},"41":{"start":{"line":55,"column":0},"end":{"line":55,"column":25}},"42":{"start":{"line":56,"column":0},"end":{"line":56,"column":25}},"43":{"start":{"line":58,"column":0},"end":{"line":58,"column":24}},"44":{"start":{"line":60,"column":0},"end":{"line":60,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":20,"column":10},"end":{"line":20,"column":11}},"loc":{"start":{"line":20,"column":38},"end":{"line":29,"column":3}},"line":20},"1":{"name":"(anonymous_1)","decl":{"start":{"line":42,"column":67},"end":{"line":42,"column":68}},"loc":{"start":{"line":42,"column":73},"end":{"line":44,"column":3}},"line":42},"2":{"name":"(anonymous_2)","decl":{"start":{"line":46,"column":63},"end":{"line":46,"column":64}},"loc":{"start":{"line":46,"column":69},"end":{"line":48,"column":3}},"line":46},"3":{"name":"(anonymous_3)","decl":{"start":{"line":51,"column":32},"end":{"line":51,"column":33}},"loc":{"start":{"line":51,"column":38},"end":{"line":53,"column":1}},"line":51}},"branchMap":{"0":{"loc":{"start":{"line":22,"column":4},"end":{"line":22,"column":45}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":45}},{"start":{"line":22,"column":4},"end":{"line":22,"column":45}}],"line":22},"1":{"loc":{"start":{"line":24,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":27,"column":5}},{"start":{"line":24,"column":4},"end":{"line":27,"column":5}}],"line":24},"2":{"loc":{"start":{"line":41,"column":0},"end":{"line":49,"column":1}},"type":"if","locations":[{"start":{"line":41,"column":0},"end":{"line":49,"column":1}},{"start":{"line":41,"column":0},"end":{"line":49,"column":1}}],"line":41}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":32,"19":32,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":1,"38":1,"39":0,"40":1,"41":1,"42":1,"43":1,"44":1},"f":{"0":32,"1":1,"2":0,"3":0},"b":{"0":[32,0],"1":[0,0],"2":[1,0]},"inputSourceMap":{"version":3,"sources":["app.js"],"names":["express","require","mongoose","app","config","bodyParser","cookieparser","cors","path","cookieSession","userRoutes","authRoutes","postRoutes","passport","session","MongoStore","allowedDomains","use","origin","callback","indexOf","msg","Error","json","urlencoded","extended","CURRENT_WORKING_DIR","process","cwd","console","log","static","join","initialize","env","NODE_ENV","connect","mongoTestUri","useNewUrlParser","mongoUri","set","connection","on","listen","port","module","exports"],"mappings":"AAAA,MAAMA,UAAQC,QAAQ,SAAR,CAAd;AACA,MAAMC,WAASD,QAAQ,UAAR,CAAf;AACA,MAAME,MAAKH,SAAX;AACA,MAAMI,SAAOH,QAAQ,UAAR,CAAb;AACA,MAAMI,aAAWJ,QAAQ,aAAR,CAAjB;AACA,MAAMK,eAAaL,QAAQ,eAAR,CAAnB;AACA,MAAMM,OAAKN,QAAQ,MAAR,CAAX;AACA,MAAMO,OAAKP,QAAQ,MAAR,CAAX;AACA,MAAMQ,gBAAgBR,QAAQ,gBAAR,CAAtB;AACAA,QAAQ,QAAR,EAAkBG,MAAlB;AACA,MAAMM,aAAWT,QAAQ,qBAAR,CAAjB;AACA,MAAMU,aAAWV,QAAQ,qBAAR,CAAjB;AACA,MAAMW,aAAWX,QAAQ,qBAAR,CAAjB;AACA,MAAMY,WAASZ,QAAQ,UAAR,CAAf;AACA,MAAMa,UAAUb,QAAQ,iBAAR,CAAhB;AACA,MAAMc,aAAad,QAAQ,eAAR,CAAnB;;AAEA,IAAIe,iBAAiB,CAAC,8CAAD,EAAiD,uBAAjD,EAAyE,4DAAzE,CAArB;AACAb,IAAIc,GAAJ,CAAQV,KAAK;AACXW,UAAQ,UAAUA,MAAV,EAAkBC,QAAlB,EAA4B;AAClC;AACA,QAAI,CAACD,MAAL,EAAa,OAAOC,SAAS,IAAT,EAAe,IAAf,CAAP;;AAEb,QAAIH,eAAeI,OAAf,CAAuBF,MAAvB,MAAmC,CAAC,CAAxC,EAA2C;AACzC,UAAIG,MAAO,aAAYH,MAAO,2EAA9B;AACA,aAAOC,SAAS,IAAIG,KAAJ,CAAUD,GAAV,CAAT,EAAyB,KAAzB,CAAP;AACD;AACD,WAAOF,SAAS,IAAT,EAAe,IAAf,CAAP;AACD;AAVU,CAAL,CAAR;AAYAhB,IAAIc,GAAJ,CAAQZ,WAAWkB,IAAX,EAAR;AACApB,IAAIc,GAAJ,CAAQZ,WAAWmB,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAtB,IAAIc,GAAJ,CAAQX,cAAR;AACA,MAAMoB,sBAAsBC,QAAQC,GAAR,EAA5B;AACAC,QAAQC,GAAR,CAAYJ,mBAAZ;AACAvB,IAAIc,GAAJ,CAAQjB,QAAQ+B,MAAR,CAAevB,KAAKwB,IAAL,CAAUN,mBAAV,EAA+B,UAA/B,CAAf,CAAR;;AAGAvB,IAAIc,GAAJ,CAAQJ,SAASoB,UAAT,EAAR;AACA9B,IAAIc,GAAJ,CAAQJ,SAASC,OAAT,EAAR;;AAIA,IAAGa,QAAQO,GAAR,CAAYC,QAAZ,KAAyB,MAA5B,EAAmC;AACjCjC,WAASkC,OAAT,CAAiBhC,OAAOiC,YAAxB,EAAqC,EAAEC,iBAAiB,IAAnB,EAArC,EAA+D,MAAI;AACjET,YAAQC,GAAR,CAAY,yBAAZ;AACD,GAFD;AAGD,CAJD,MAKI;AACF5B,WAASkC,OAAT,CAAiBhC,OAAOmC,QAAxB,EAAiC,EAAED,iBAAiB,IAAnB,EAAjC,EAA2D,MAAI;AAC3DT,YAAQC,GAAR,CAAY,iBAAZ;AACH,GAFD;AAGD;AACD5B,SAASsC,GAAT,CAAa,kBAAb,EAAiC,KAAjC;AACAtC,SAASuC,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,MAAM;AACpC,QAAM,IAAIpB,KAAJ,CAAW,+BAAX,CAAN;AACD,CAFD;AAGAnB,IAAIc,GAAJ,CAAQ,GAAR,EAAaP,UAAb;AACAP,IAAIc,GAAJ,CAAQ,GAAR,EAAaN,UAAb;AACAR,IAAIc,GAAJ,CAAQ,GAAR,EAAaL,UAAb;;AAGAT,IAAIwC,MAAJ,CAAWvC,OAAOwC,IAAlB;;AAEAC,OAAOC,OAAP,GAAiB,EAAC3C,GAAD,EAAjB","file":"app.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project","sourcesContent":["const express=require('express')\r\nconst mongoose=require('mongoose')\r\nconst app= express()\r\nconst config=require('./config')\r\nconst bodyParser=require('body-parser')\r\nconst cookieparser=require('cookie-parser')\r\nconst cors=require('cors')\r\nconst path=require('path')\r\nconst cookieSession = require('cookie-session');\r\nrequire('dotenv').config()\r\nconst userRoutes=require('./routes/userroutes')\r\nconst authRoutes=require('./routes/authroutes')\r\nconst postRoutes=require('./routes/postroutes')\r\nconst passport=require('passport')\r\nconst session = require('express-session');\r\nconst MongoStore = require('connect-mongo')\r\n\r\nvar allowedDomains = ['https://accounts.google.com/o/oauth2/v2/auth', 'http://localhost:3000','https://openforumsocial.herokuapp.com/auth/google/callback'];\r\napp.use(cors({\r\n  origin: function (origin, callback) {\r\n    // bypass the requests with no origin (like curl requests, mobile apps, etc )\r\n    if (!origin) return callback(null, true);\r\n \r\n    if (allowedDomains.indexOf(origin) === -1) {\r\n      var msg = `This site ${origin} does not have an access. Only specific domains are allowed to access it.`;\r\n      return callback(new Error(msg), false);\r\n    }\r\n    return callback(null, true);\r\n  }\r\n}));\r\napp.use(bodyParser.json())\r\napp.use(bodyParser.urlencoded({ extended: true }))\r\napp.use(cookieparser())\r\nconst CURRENT_WORKING_DIR = process.cwd()\r\nconsole.log(CURRENT_WORKING_DIR)\r\napp.use(express.static(path.join(CURRENT_WORKING_DIR, \"./assets\")))\r\n\r\n\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\n\r\n\r\n\r\nif(process.env.NODE_ENV === 'test'){\r\n  mongoose.connect(config.mongoTestUri,{ useNewUrlParser: true },()=>{\r\n    console.log('connected to testing db')\r\n  })\r\n}\r\nelse{\r\n  mongoose.connect(config.mongoUri,{ useNewUrlParser: true },()=>{\r\n      console.log('connected to db')\r\n  })\r\n}\r\nmongoose.set('useFindAndModify', false);\r\nmongoose.connection.on('error', () => {\r\n  throw new Error(`unable to connect to database`)\r\n})\r\napp.use('/', userRoutes)\r\napp.use('/', authRoutes)\r\napp.use('/', postRoutes)\r\n\r\n\r\napp.listen(config.port)\r\n\r\nmodule.exports = {app};\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f19545c532d3ee7b232ef5b510a02bfa5f3e3474","contentHash":"65bc4f50b818fbcb5f7739e58547524967069560116e6f740526af71b9fff43f"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\config.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\config.js","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"1":{"start":{"line":2,"column":15},"end":{"line":13,"column":1}},"2":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":3,"column":9},"end":{"line":3,"column":46}},"type":"binary-expr","locations":[{"start":{"line":3,"column":9},"end":{"line":3,"column":29}},{"start":{"line":3,"column":33},"end":{"line":3,"column":46}}],"line":3},"1":{"loc":{"start":{"line":4,"column":10},"end":{"line":4,"column":32}},"type":"binary-expr","locations":[{"start":{"line":4,"column":10},"end":{"line":4,"column":26}},{"start":{"line":4,"column":30},"end":{"line":4,"column":32}}],"line":4},"2":{"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":58}},"type":"binary-expr","locations":[{"start":{"line":5,"column":15},"end":{"line":5,"column":37}},{"start":{"line":5,"column":41},"end":{"line":5,"column":58}}],"line":5},"3":{"loc":{"start":{"line":11,"column":15},"end":{"line":11,"column":45}},"type":"binary-expr","locations":[{"start":{"line":11,"column":15},"end":{"line":11,"column":37}},{"start":{"line":11,"column":41},"end":{"line":11,"column":45}}],"line":11}},"s":{"0":1,"1":1,"2":1},"f":{},"b":{"0":[1,0],"1":[1,1],"2":[1,1],"3":[1,1]},"inputSourceMap":{"version":3,"sources":["config.js"],"names":["require","config","env","process","NODE_ENV","port","PORT","jwtSecret","JWT_SECRET","mongoUri","MONGODB_URI","mongoTestUri","MONGODB_TEST_URI","clientid","GOOGLE_CLIENT_ID","clientsecret","GOOGLE_CLIENT_SECRET","redisurl","REDISCLOUD_URL","redisport","REDIS_PORT","module","exports"],"mappings":"AAAAA,QAAQ,QAAR,EAAkBC,MAAlB;AACA,MAAMA,SAAS;AACXC,SAAKC,QAAQD,GAAR,CAAYE,QAAZ,IAAwB,aADlB;AAEXC,UAAMF,QAAQD,GAAR,CAAYI,IAAZ,IAAoB,EAFf;AAGXC,eAAWJ,QAAQD,GAAR,CAAYM,UAAZ,IAA0B,iBAH1B;AAIXC,cAAUN,QAAQD,GAAR,CAAYQ,WAJX;AAKXC,kBAAcR,QAAQD,GAAR,CAAYU,gBALf;AAMXC,cAASV,QAAQD,GAAR,CAAYY,gBANV;AAOXC,kBAAaZ,QAAQD,GAAR,CAAYc,oBAPd;AAQXC,cAASd,QAAQD,GAAR,CAAYgB,cARV;AASXC,eAAUhB,QAAQD,GAAR,CAAYkB,UAAZ,IAAwB;;AATvB,CAAf;;AAaEC,OAAOC,OAAP,GAAerB,MAAf","file":"config.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project","sourcesContent":["require('dotenv').config()\r\nconst config = {\r\n    env: process.env.NODE_ENV || 'development',\r\n    port: process.env.PORT || 80,\r\n    jwtSecret: process.env.JWT_SECRET || \"YOUR_secret_key\",\r\n    mongoUri: process.env.MONGODB_URI,\r\n    mongoTestUri: process.env.MONGODB_TEST_URI,\r\n    clientid:process.env.GOOGLE_CLIENT_ID,\r\n    clientsecret:process.env.GOOGLE_CLIENT_SECRET,\r\n    redisurl:process.env.REDISCLOUD_URL,\r\n    redisport:process.env.REDIS_PORT||6379\r\n\r\n  }\r\n  \r\n  module.exports=config"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1a77cdff020c5f6726ab6f70cb1142830fc240d6","contentHash":"5d20cdda16689378c5ce531ef81fd7f0da1bd06822b6b5fac4d468076b256523"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\userroutes.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\userroutes.js","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":17},"end":{"line":2,"column":58}},"2":{"start":{"line":3,"column":17},"end":{"line":3,"column":58}},"3":{"start":{"line":4,"column":18},"end":{"line":4,"column":56}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":31}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":68}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":84}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":67}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":107}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":115}},"10":{"start":{"line":16,"column":0},"end":{"line":16,"column":95}},"11":{"start":{"line":18,"column":0},"end":{"line":18,"column":225}},"12":{"start":{"line":20,"column":0},"end":{"line":20,"column":56}},"13":{"start":{"line":22,"column":0},"end":{"line":22,"column":42}},"14":{"start":{"line":24,"column":0},"end":{"line":24,"column":24}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["userroutes.js"],"names":["express","require","userCtrl","authCtrl","lbcontrol","router","Router","route","get","list","post","create","photo","defaultPhoto","put","requireSignin","addFollowing","addFollower","removeFollowing","removeFollower","findPeople","read","hasAuthorization","update","delete","remove","leaderboard","param","userByID","module","exports"],"mappings":"AAAA,MAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,MAAMC,WAAWD,QAAQ,gCAAR,CAAjB;AACA,MAAME,WAASF,QAAQ,gCAAR,CAAf;AACA,MAAMG,YAAUH,QAAQ,6BAAR,CAAhB;;AAGA,MAAMI,SAASL,QAAQM,MAAR,EAAf;;AAEAD,OAAOE,KAAP,CAAa,YAAb,EAA2BC,GAA3B,CAA+BN,SAASO,IAAxC,EAA8CC,IAA9C,CAAmDR,SAASS,MAA5D;;AAEAN,OACGE,KADH,CACS,0BADT,EAEGC,GAFH,CAEON,SAASU,KAFhB,EAEuBV,SAASW,YAFhC;AAGAR,OAAOE,KAAP,CAAa,yBAAb,EAAwCC,GAAxC,CAA4CN,SAASW,YAArD;;AAEAR,OACGE,KADH,CACS,mBADT,EAEGO,GAFH,CAEOX,SAASY,aAFhB,EAE+Bb,SAASc,YAFxC,EAEsDd,SAASe,WAF/D;AAGAZ,OACGE,KADH,CACS,qBADT,EAEGO,GAFH,CAGIX,SAASY,aAHb,EAIIb,SAASgB,eAJb,EAKIhB,SAASiB,cALb;;AAQAd,OACGE,KADH,CACS,+BADT,EAEGC,GAFH,CAEOL,SAASY,aAFhB,EAE+Bb,SAASkB,UAFxC;;AAIAf,OACGE,KADH,CACS,oBADT,EAEGC,GAFH,CAEOL,SAASY,aAFhB,EAE+Bb,SAASmB,IAFxC,EAGGP,GAHH,CAGOX,SAASY,aAHhB,EAG+BZ,SAASmB,gBAHxC,EAG0DpB,SAASqB,MAHnE,EAIGC,MAJH,CAIUrB,SAASY,aAJnB,EAIkCZ,SAASmB,gBAJ3C,EAI6DpB,SAASuB,MAJtE;;AAMApB,OAAOE,KAAP,CAAa,cAAb,EAA6BC,GAA7B,CAAiCJ,UAAUsB,WAA3C;;AAEArB,OAAOsB,KAAP,CAAa,QAAb,EAAuBzB,SAAS0B,QAAhC;;AAEAC,OAAOC,OAAP,GAAiBzB,MAAjB","file":"userroutes.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/routes","sourcesContent":["const express = require(\"express\");\r\nconst userCtrl = require(\"../controllers/userControllers\");\r\nconst authCtrl=require('../controllers/authControllers')\r\nconst lbcontrol=require('../controllers/lbcontroller')\r\n\r\n\r\nconst router = express.Router();\r\n\r\nrouter.route(\"/api/users\").get(userCtrl.list).post(userCtrl.create);\r\n\r\nrouter\r\n  .route(\"/api/users/photo/:userId\")\r\n  .get(userCtrl.photo, userCtrl.defaultPhoto);\r\nrouter.route(\"/api/users/defaultphoto\").get(userCtrl.defaultPhoto);\r\n\r\nrouter\r\n  .route(\"/api/users/follow\")\r\n  .put(authCtrl.requireSignin, userCtrl.addFollowing, userCtrl.addFollower);\r\nrouter\r\n  .route(\"/api/users/unfollow\")\r\n  .put(\r\n    authCtrl.requireSignin,\r\n    userCtrl.removeFollowing,\r\n    userCtrl.removeFollower\r\n  );\r\n\r\nrouter\r\n  .route(\"/api/users/findpeople/:userId\")\r\n  .get(authCtrl.requireSignin, userCtrl.findPeople);\r\n\r\nrouter\r\n  .route(\"/api/users/:userId\")\r\n  .get(authCtrl.requireSignin, userCtrl.read)\r\n  .put(authCtrl.requireSignin, authCtrl.hasAuthorization, userCtrl.update)\r\n  .delete(authCtrl.requireSignin, authCtrl.hasAuthorization, userCtrl.remove);\r\n\r\nrouter.route(\"/leaderboard\").get(lbcontrol.leaderboard)\r\n\r\nrouter.param(\"userId\", userCtrl.userByID);\r\n\r\nmodule.exports = router;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81f1331a6a689bc2d64282305ea1dcd1135e20b8","contentHash":"5b2d735103b546ad2242f7e42180ac64a25dac07469ed1f6b6115c5761c596ec"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\userControllers.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\userControllers.js","statementMap":{"0":{"start":{"line":1,"column":13},"end":{"line":1,"column":38}},"1":{"start":{"line":2,"column":19},"end":{"line":2,"column":40}},"2":{"start":{"line":3,"column":11},"end":{"line":3,"column":24}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":32}},"4":{"start":{"line":6,"column":15},"end":{"line":18,"column":1}},"5":{"start":{"line":7,"column":15},"end":{"line":7,"column":33}},"6":{"start":{"line":8,"column":2},"end":{"line":17,"column":3}},"7":{"start":{"line":9,"column":4},"end":{"line":9,"column":22}},"8":{"start":{"line":10,"column":4},"end":{"line":12,"column":7}},"9":{"start":{"line":14,"column":4},"end":{"line":16,"column":7}},"10":{"start":{"line":20,"column":17},"end":{"line":33,"column":1}},"11":{"start":{"line":21,"column":2},"end":{"line":32,"column":3}},"12":{"start":{"line":22,"column":15},"end":{"line":22,"column":113}},"13":{"start":{"line":23,"column":4},"end":{"line":25,"column":7}},"14":{"start":{"line":23,"column":15},"end":{"line":25,"column":7}},"15":{"start":{"line":26,"column":4},"end":{"line":26,"column":23}},"16":{"start":{"line":27,"column":4},"end":{"line":27,"column":11}},"17":{"start":{"line":29,"column":4},"end":{"line":31,"column":7}},"18":{"start":{"line":35,"column":13},"end":{"line":39,"column":1}},"19":{"start":{"line":36,"column":2},"end":{"line":36,"column":42}},"20":{"start":{"line":37,"column":2},"end":{"line":37,"column":31}},"21":{"start":{"line":38,"column":2},"end":{"line":38,"column":31}},"22":{"start":{"line":41,"column":13},"end":{"line":50,"column":1}},"23":{"start":{"line":42,"column":2},"end":{"line":49,"column":3}},"24":{"start":{"line":43,"column":16},"end":{"line":43,"column":70}},"25":{"start":{"line":44,"column":4},"end":{"line":44,"column":20}},"26":{"start":{"line":46,"column":4},"end":{"line":48,"column":7}},"27":{"start":{"line":52,"column":15},"end":{"line":79,"column":1}},"28":{"start":{"line":53,"column":13},"end":{"line":53,"column":42}},"29":{"start":{"line":54,"column":2},"end":{"line":54,"column":29}},"30":{"start":{"line":55,"column":2},"end":{"line":78,"column":5}},"31":{"start":{"line":56,"column":4},"end":{"line":60,"column":5}},"32":{"start":{"line":57,"column":6},"end":{"line":59,"column":9}},"33":{"start":{"line":61,"column":15},"end":{"line":61,"column":26}},"34":{"start":{"line":62,"column":4},"end":{"line":62,"column":32}},"35":{"start":{"line":63,"column":4},"end":{"line":63,"column":30}},"36":{"start":{"line":64,"column":4},"end":{"line":67,"column":5}},"37":{"start":{"line":65,"column":6},"end":{"line":65,"column":58}},"38":{"start":{"line":66,"column":6},"end":{"line":66,"column":48}},"39":{"start":{"line":68,"column":4},"end":{"line":77,"column":7}},"40":{"start":{"line":69,"column":6},"end":{"line":73,"column":7}},"41":{"start":{"line":70,"column":8},"end":{"line":72,"column":11}},"42":{"start":{"line":74,"column":6},"end":{"line":74,"column":39}},"43":{"start":{"line":75,"column":6},"end":{"line":75,"column":28}},"44":{"start":{"line":76,"column":6},"end":{"line":76,"column":21}},"45":{"start":{"line":81,"column":15},"end":{"line":93,"column":1}},"46":{"start":{"line":82,"column":2},"end":{"line":92,"column":3}},"47":{"start":{"line":83,"column":15},"end":{"line":83,"column":26}},"48":{"start":{"line":84,"column":22},"end":{"line":84,"column":41}},"49":{"start":{"line":85,"column":4},"end":{"line":85,"column":44}},"50":{"start":{"line":86,"column":4},"end":{"line":86,"column":33}},"51":{"start":{"line":87,"column":4},"end":{"line":87,"column":26}},"52":{"start":{"line":89,"column":4},"end":{"line":91,"column":7}},"53":{"start":{"line":95,"column":14},"end":{"line":101,"column":1}},"54":{"start":{"line":96,"column":2},"end":{"line":99,"column":3}},"55":{"start":{"line":97,"column":4},"end":{"line":97,"column":59}},"56":{"start":{"line":98,"column":4},"end":{"line":98,"column":44}},"57":{"start":{"line":100,"column":2},"end":{"line":100,"column":9}},"58":{"start":{"line":103,"column":21},"end":{"line":105,"column":1}},"59":{"start":{"line":104,"column":2},"end":{"line":104,"column":50}},"60":{"start":{"line":107,"column":21},"end":{"line":119,"column":1}},"61":{"start":{"line":108,"column":2},"end":{"line":118,"column":3}},"62":{"start":{"line":109,"column":4},"end":{"line":111,"column":7}},"63":{"start":{"line":112,"column":4},"end":{"line":112,"column":39}},"64":{"start":{"line":113,"column":4},"end":{"line":113,"column":11}},"65":{"start":{"line":115,"column":4},"end":{"line":117,"column":7}},"66":{"start":{"line":121,"column":20},"end":{"line":133,"column":1}},"67":{"start":{"line":122,"column":2},"end":{"line":132,"column":3}},"68":{"start":{"line":123,"column":17},"end":{"line":123,"column":197}},"69":{"start":{"line":124,"column":4},"end":{"line":124,"column":39}},"70":{"start":{"line":125,"column":4},"end":{"line":125,"column":28}},"71":{"start":{"line":126,"column":4},"end":{"line":126,"column":38}},"72":{"start":{"line":127,"column":4},"end":{"line":127,"column":21}},"73":{"start":{"line":129,"column":4},"end":{"line":131,"column":7}},"74":{"start":{"line":135,"column":24},"end":{"line":147,"column":1}},"75":{"start":{"line":136,"column":2},"end":{"line":146,"column":3}},"76":{"start":{"line":137,"column":4},"end":{"line":139,"column":7}},"77":{"start":{"line":140,"column":4},"end":{"line":140,"column":38}},"78":{"start":{"line":141,"column":4},"end":{"line":141,"column":11}},"79":{"start":{"line":143,"column":4},"end":{"line":145,"column":7}},"80":{"start":{"line":148,"column":23},"end":{"line":160,"column":1}},"81":{"start":{"line":149,"column":2},"end":{"line":159,"column":3}},"82":{"start":{"line":150,"column":17},"end":{"line":150,"column":199}},"83":{"start":{"line":151,"column":4},"end":{"line":151,"column":39}},"84":{"start":{"line":152,"column":4},"end":{"line":152,"column":28}},"85":{"start":{"line":153,"column":4},"end":{"line":153,"column":41}},"86":{"start":{"line":154,"column":4},"end":{"line":154,"column":21}},"87":{"start":{"line":156,"column":4},"end":{"line":158,"column":7}},"88":{"start":{"line":162,"column":19},"end":{"line":173,"column":1}},"89":{"start":{"line":163,"column":18},"end":{"line":163,"column":39}},"90":{"start":{"line":164,"column":2},"end":{"line":164,"column":34}},"91":{"start":{"line":165,"column":2},"end":{"line":172,"column":3}},"92":{"start":{"line":166,"column":16},"end":{"line":166,"column":76}},"93":{"start":{"line":167,"column":4},"end":{"line":167,"column":20}},"94":{"start":{"line":169,"column":4},"end":{"line":171,"column":7}},"95":{"start":{"line":175,"column":20},"end":{"line":181,"column":1}},"96":{"start":{"line":176,"column":2},"end":{"line":180,"column":5}},"97":{"start":{"line":177,"column":4},"end":{"line":179,"column":5}},"98":{"start":{"line":178,"column":6},"end":{"line":178,"column":17}},"99":{"start":{"line":183,"column":0},"end":{"line":197,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":15},"end":{"line":6,"column":16}},"loc":{"start":{"line":6,"column":35},"end":{"line":18,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":20,"column":17},"end":{"line":20,"column":18}},"loc":{"start":{"line":20,"column":47},"end":{"line":33,"column":1}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":35,"column":13},"end":{"line":35,"column":14}},"loc":{"start":{"line":35,"column":27},"end":{"line":39,"column":1}},"line":35},"3":{"name":"(anonymous_3)","decl":{"start":{"line":41,"column":13},"end":{"line":41,"column":14}},"loc":{"start":{"line":41,"column":33},"end":{"line":50,"column":1}},"line":41},"4":{"name":"(anonymous_4)","decl":{"start":{"line":52,"column":15},"end":{"line":52,"column":16}},"loc":{"start":{"line":52,"column":29},"end":{"line":79,"column":1}},"line":52},"5":{"name":"(anonymous_5)","decl":{"start":{"line":55,"column":18},"end":{"line":55,"column":19}},"loc":{"start":{"line":55,"column":42},"end":{"line":78,"column":3}},"line":55},"6":{"name":"(anonymous_6)","decl":{"start":{"line":68,"column":14},"end":{"line":68,"column":15}},"loc":{"start":{"line":68,"column":31},"end":{"line":77,"column":5}},"line":68},"7":{"name":"(anonymous_7)","decl":{"start":{"line":81,"column":15},"end":{"line":81,"column":16}},"loc":{"start":{"line":81,"column":35},"end":{"line":93,"column":1}},"line":81},"8":{"name":"(anonymous_8)","decl":{"start":{"line":95,"column":14},"end":{"line":95,"column":15}},"loc":{"start":{"line":95,"column":34},"end":{"line":101,"column":1}},"line":95},"9":{"name":"(anonymous_9)","decl":{"start":{"line":103,"column":21},"end":{"line":103,"column":22}},"loc":{"start":{"line":103,"column":35},"end":{"line":105,"column":1}},"line":103},"10":{"name":"(anonymous_10)","decl":{"start":{"line":107,"column":21},"end":{"line":107,"column":22}},"loc":{"start":{"line":107,"column":47},"end":{"line":119,"column":1}},"line":107},"11":{"name":"(anonymous_11)","decl":{"start":{"line":121,"column":20},"end":{"line":121,"column":21}},"loc":{"start":{"line":121,"column":40},"end":{"line":133,"column":1}},"line":121},"12":{"name":"(anonymous_12)","decl":{"start":{"line":135,"column":24},"end":{"line":135,"column":25}},"loc":{"start":{"line":135,"column":50},"end":{"line":147,"column":1}},"line":135},"13":{"name":"(anonymous_13)","decl":{"start":{"line":148,"column":23},"end":{"line":148,"column":24}},"loc":{"start":{"line":148,"column":43},"end":{"line":160,"column":1}},"line":148},"14":{"name":"(anonymous_14)","decl":{"start":{"line":162,"column":19},"end":{"line":162,"column":20}},"loc":{"start":{"line":162,"column":39},"end":{"line":173,"column":1}},"line":162},"15":{"name":"(anonymous_15)","decl":{"start":{"line":175,"column":20},"end":{"line":175,"column":21}},"loc":{"start":{"line":175,"column":40},"end":{"line":181,"column":1}},"line":175},"16":{"name":"(anonymous_16)","decl":{"start":{"line":176,"column":75},"end":{"line":176,"column":76}},"loc":{"start":{"line":176,"column":92},"end":{"line":180,"column":3}},"line":176}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":4},"end":{"line":25,"column":7}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":25,"column":7}},{"start":{"line":23,"column":4},"end":{"line":25,"column":7}}],"line":23},"1":{"loc":{"start":{"line":56,"column":4},"end":{"line":60,"column":5}},"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":60,"column":5}},{"start":{"line":56,"column":4},"end":{"line":60,"column":5}}],"line":56},"2":{"loc":{"start":{"line":64,"column":4},"end":{"line":67,"column":5}},"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":67,"column":5}},{"start":{"line":64,"column":4},"end":{"line":67,"column":5}}],"line":64},"3":{"loc":{"start":{"line":69,"column":6},"end":{"line":73,"column":7}},"type":"if","locations":[{"start":{"line":69,"column":6},"end":{"line":73,"column":7}},{"start":{"line":69,"column":6},"end":{"line":73,"column":7}}],"line":69},"4":{"loc":{"start":{"line":96,"column":2},"end":{"line":99,"column":3}},"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":99,"column":3}},{"start":{"line":96,"column":2},"end":{"line":99,"column":3}}],"line":96},"5":{"loc":{"start":{"line":177,"column":4},"end":{"line":179,"column":5}},"type":"if","locations":[{"start":{"line":177,"column":4},"end":{"line":179,"column":5}},{"start":{"line":177,"column":4},"end":{"line":179,"column":5}}],"line":177}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":3,"7":3,"8":1,"9":2,"10":1,"11":9,"12":9,"13":8,"14":0,"15":8,"16":8,"17":1,"18":1,"19":0,"20":0,"21":0,"22":1,"23":2,"24":2,"25":2,"26":0,"27":1,"28":1,"29":1,"30":1,"31":1,"32":0,"33":1,"34":1,"35":1,"36":1,"37":0,"38":0,"39":1,"40":1,"41":0,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":0,"53":1,"54":1,"55":0,"56":0,"57":1,"58":1,"59":1,"60":1,"61":3,"62":3,"63":1,"64":1,"65":2,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":0,"74":1,"75":1,"76":1,"77":1,"78":1,"79":0,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":0,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":0,"95":1,"96":4,"97":4,"98":0,"99":1},"f":{"0":3,"1":9,"2":0,"3":2,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":3,"11":1,"12":1,"13":1,"14":1,"15":4,"16":4},"b":{"0":[0,8],"1":[0,1],"2":[0,1],"3":[0,1],"4":[0,1],"5":[0,4]},"inputSourceMap":{"version":3,"sources":["userControllers.js"],"names":["User","require","formidable","fs","extend","create","req","res","user","body","save","status","json","message","err","error","userByID","next","id","findById","populate","exec","profile","read","hashed_password","undefined","salt","list","users","find","select","update","form","IncomingForm","keepExtensions","parse","fields","files","updated","Date","now","photo","data","readFileSync","path","contentType","type","result","errorHandler","getErrorMessage","remove","deletedUser","set","send","defaultPhoto","sendFile","__dirname","addFollowing","findByIdAndUpdate","userId","$push","following","followId","updateScore","addFollower","followers","new","removeFollowing","$pull","unfollowId","removeFollower","findPeople","push","_id","$nin","points","findOneAndUpdate","$inc","score","module","exports"],"mappings":"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","file":"userControllers.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/controllers","sourcesContent":["const User = require(\"../models/user\");\r\nconst formidable = require(\"formidable\");\r\nconst fs = require(\"fs\");\r\nconst extend = require(\"extend\");\r\n\r\nconst create = async(req, res) => {\r\n  const user = new User(req.body);\r\n  try {\r\n  await user.save();\r\n    return res.status(200).json({\r\n      message: \"Successfully signed up!\",\r\n    });\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst userByID = async (req, res, next, id) => {\r\n  try {\r\n    let user = await User.findById(id)\r\n      .populate(\"following\", \"_id name\")\r\n      .populate(\"followers\", \"_id name\")\r\n      .exec();\r\n    if (!user)\r\n      return res.status(\"400\").json({\r\n        error: \"User not found\",\r\n      });\r\n    req.profile = user;\r\n    next();\r\n  } catch (err) {\r\n    return res.status(\"400\").json({\r\n      error: \"Could not retrieve user\",\r\n    });\r\n  }\r\n};\r\n\r\nconst read = (req, res) => {\r\n  req.profile.hashed_password = undefined;\r\n  req.profile.salt = undefined;\r\n  return res.json(req.profile);\r\n};\r\n\r\nconst list = async (req, res) => {\r\n  try {\r\n    let users = await User.find().select(\"name email updated created\");\r\n    res.json(users);\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst update = (req, res) => {\r\n  let form = new formidable.IncomingForm();\r\n  form.keepExtensions = true;\r\n  form.parse(req, (err, fields, files) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: \"Photo could not be uploaded\",\r\n      });\r\n    }\r\n    let user = req.profile;\r\n    user = extend(user, fields);\r\n    user.updated = Date.now();\r\n    if (files.photo) {\r\n      user.photo.data = fs.readFileSync(files.photo.path);\r\n      user.photo.contentType = files.photo.type;\r\n    }\r\n    user.save((err, result) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: errorHandler.getErrorMessage(err)\r\n        })\r\n      }\r\n      user.hashed_password = undefined\r\n      user.salt = undefined\r\n      res.json(user)\r\n    })\r\n  })\r\n  }\r\n\r\n\r\nconst remove = async (req, res) => {\r\n  try {\r\n    let user = req.profile;\r\n    let deletedUser = await user.remove();\r\n    deletedUser.hashed_password = undefined;\r\n    deletedUser.salt = undefined;\r\n    res.json(deletedUser);\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst photo = (req, res, next) => {\r\n  if (req.profile.photo.data) {\r\n    res.set(\"Content-Type\", req.profile.photo.contentType);\r\n    return res.send(req.profile.photo.data);\r\n  }\r\n  next();\r\n};\r\n\r\nconst defaultPhoto = (req, res) => {\r\n  return res.sendFile(__dirname+'/profile.png');\r\n};\r\n\r\nconst addFollowing = async (req, res, next) => {\r\n  try {\r\n    await User.findByIdAndUpdate(req.body.userId, {\r\n      $push: { following: req.body.followId },\r\n    });\r\n    updateScore(req.body.userId,-0.5)\r\n    next();\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst addFollower = async (req, res) => {\r\n  try {\r\n    let result = await User.findByIdAndUpdate(\r\n      req.body.followId,\r\n      { $push: { followers: req.body.userId } },\r\n      { new: true }\r\n    )\r\n      .populate(\"following\", \"_id name\")\r\n      .populate(\"followers\", \"_id name\")\r\n      .exec();\r\n    result.hashed_password = undefined;\r\n    result.salt = undefined;\r\n    updateScore(req.body.followId,1)\r\n    res.json(result);\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst removeFollowing = async (req, res, next) => {\r\n  try {\r\n    await User.findByIdAndUpdate(req.body.userId, {\r\n      $pull: { following: req.body.unfollowId },\r\n    });\r\n    updateScore(req.body.userId,0.5)\r\n    next();\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: errorHandler.err,\r\n    });\r\n  }\r\n};\r\nconst removeFollower = async (req, res) => {\r\n  try {\r\n    let result = await User.findByIdAndUpdate(\r\n      req.body.unfollowId,\r\n      { $pull: { followers: req.body.userId } },\r\n      { new: true }\r\n    )\r\n      .populate(\"following\", \"_id name\")\r\n      .populate(\"followers\", \"_id name\")\r\n      .exec();\r\n    result.hashed_password = undefined;\r\n    result.salt = undefined;\r\n    updateScore(req.body.unfollowId,-1)\r\n    res.json(result);\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst findPeople = async (req, res) => {\r\n  let following = req.profile.following;\r\n  following.push(req.profile._id);\r\n  try {\r\n    let users = await User.find({ _id: { $nin: following } }).select(\"name\");\r\n    res.json(users);\r\n  } catch (err) {\r\n    return res.status(400).json({\r\n      error: err,\r\n    });\r\n  }\r\n};\r\n\r\nconst updateScore = (userId, points) => {\r\n  User.findOneAndUpdate({ _id: userId }, { $inc: { score: points } }).exec(\r\n    (err, result) => {\r\n      if (err) {\r\n        return err;\r\n      }\r\n    }\r\n  );\r\n};\r\n\r\nmodule.exports={\r\n  create,\r\n  userByID,\r\n  read,\r\n  list,\r\n  remove,\r\n  update,\r\n  photo,\r\n  defaultPhoto,\r\n  addFollowing,\r\n  addFollower,\r\n  removeFollowing,\r\n  removeFollower,\r\n  findPeople,\r\n};\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4414e44c533ea7fb8ce9a1aca124a97f0597588d","contentHash":"b1e664f592f85db3764f862ae184b992c28b368c61b7bbae6d15575416cdcb15"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\models\\user.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\models\\user.js","statementMap":{"0":{"start":{"line":1,"column":15},"end":{"line":1,"column":32}},"1":{"start":{"line":2,"column":17},"end":{"line":2,"column":36}},"2":{"start":{"line":3,"column":19},"end":{"line":64,"column":2}},"3":{"start":{"line":66,"column":0},"end":{"line":72,"column":3}},"4":{"start":{"line":67,"column":2},"end":{"line":67,"column":28}},"5":{"start":{"line":68,"column":2},"end":{"line":68,"column":30}},"6":{"start":{"line":69,"column":2},"end":{"line":69,"column":56}},"7":{"start":{"line":71,"column":2},"end":{"line":71,"column":24}},"8":{"start":{"line":74,"column":0},"end":{"line":81,"column":9}},"9":{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},"10":{"start":{"line":76,"column":4},"end":{"line":76,"column":75}},"11":{"start":{"line":78,"column":2},"end":{"line":80,"column":3}},"12":{"start":{"line":79,"column":4},"end":{"line":79,"column":56}},"13":{"start":{"line":83,"column":0},"end":{"line":98,"column":2}},"14":{"start":{"line":85,"column":4},"end":{"line":85,"column":68}},"15":{"start":{"line":88,"column":4},"end":{"line":88,"column":29}},"16":{"start":{"line":88,"column":19},"end":{"line":88,"column":29}},"17":{"start":{"line":89,"column":4},"end":{"line":93,"column":5}},"18":{"start":{"line":90,"column":6},"end":{"line":90,"column":81}},"19":{"start":{"line":92,"column":6},"end":{"line":92,"column":16}},"20":{"start":{"line":96,"column":4},"end":{"line":96,"column":65}},"21":{"start":{"line":100,"column":0},"end":{"line":100,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":66,"column":35},"end":{"line":66,"column":36}},"loc":{"start":{"line":66,"column":55},"end":{"line":70,"column":1}},"line":66},"1":{"name":"(anonymous_1)","decl":{"start":{"line":70,"column":7},"end":{"line":70,"column":8}},"loc":{"start":{"line":70,"column":19},"end":{"line":72,"column":1}},"line":70},"2":{"name":"(anonymous_2)","decl":{"start":{"line":74,"column":44},"end":{"line":74,"column":45}},"loc":{"start":{"line":74,"column":57},"end":{"line":81,"column":1}},"line":74},"3":{"name":"(anonymous_3)","decl":{"start":{"line":84,"column":16},"end":{"line":84,"column":17}},"loc":{"start":{"line":84,"column":37},"end":{"line":86,"column":3}},"line":84},"4":{"name":"(anonymous_4)","decl":{"start":{"line":87,"column":19},"end":{"line":87,"column":20}},"loc":{"start":{"line":87,"column":39},"end":{"line":94,"column":3}},"line":87},"5":{"name":"(anonymous_5)","decl":{"start":{"line":95,"column":12},"end":{"line":95,"column":13}},"loc":{"start":{"line":95,"column":24},"end":{"line":97,"column":3}},"line":95}},"branchMap":{"0":{"loc":{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},{"start":{"line":75,"column":2},"end":{"line":77,"column":3}}],"line":75},"1":{"loc":{"start":{"line":75,"column":6},"end":{"line":75,"column":49}},"type":"binary-expr","locations":[{"start":{"line":75,"column":6},"end":{"line":75,"column":20}},{"start":{"line":75,"column":24},"end":{"line":75,"column":49}}],"line":75},"2":{"loc":{"start":{"line":78,"column":2},"end":{"line":80,"column":3}},"type":"if","locations":[{"start":{"line":78,"column":2},"end":{"line":80,"column":3}},{"start":{"line":78,"column":2},"end":{"line":80,"column":3}}],"line":78},"3":{"loc":{"start":{"line":78,"column":6},"end":{"line":78,"column":35}},"type":"binary-expr","locations":[{"start":{"line":78,"column":6},"end":{"line":78,"column":16}},{"start":{"line":78,"column":20},"end":{"line":78,"column":35}}],"line":78},"4":{"loc":{"start":{"line":88,"column":4},"end":{"line":88,"column":29}},"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":29}},{"start":{"line":88,"column":4},"end":{"line":88,"column":29}}],"line":88}},"s":{"0":1,"1":1,"2":1,"3":1,"4":2,"5":2,"6":2,"7":0,"8":1,"9":3,"10":0,"11":3,"12":0,"13":1,"14":4,"15":6,"16":0,"17":6,"18":6,"19":0,"20":2,"21":1},"f":{"0":2,"1":0,"2":3,"3":4,"4":6,"5":2},"b":{"0":[0,3],"1":[3,2],"2":[0,3],"3":[3,2],"4":[0,6]},"inputSourceMap":{"version":3,"sources":["user.js"],"names":["crypto","require","mongoose","UserSchema","Schema","name","type","String","trim","required","email","unique","match","hashed_password","salt","updated","Date","signintype","default","Country","dob","role","score","Number","badge","created","now","about","photo","data","Buffer","contentType","following","ObjectId","ref","followers","virtual","set","password","_password","makeSalt","encryptPassword","get","path","validate","v","length","invalidate","isNew","methods","authenticate","plainText","createHmac","update","digest","err","Math","round","valueOf","random","module","exports","model"],"mappings":"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","file":"user.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/models","sourcesContent":["const crypto = require(\"crypto\");\r\nconst mongoose = require(\"mongoose\");\r\nconst UserSchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    trim: true,\r\n    required: \"Name is required\",\r\n  },\r\n  email: {\r\n    type: String,\r\n    trim: true,\r\n    unique: \"Email already exists\",\r\n    match: [/.+\\@.+\\..+/, \"Please fill a valid email address\"],\r\n    required: \"Email is required\",\r\n  },\r\n  hashed_password: {\r\n    type: String,\r\n    required: \"Password is required\",\r\n  },\r\n  salt: String,\r\n  updated: Date,\r\n  signintype:{\r\n    type:String,\r\n    default:\"Manual\",\r\n    required:true,\r\n  },\r\n  Country:{\r\n    type:String,\r\n    \r\n  },\r\n  dob:{\r\n  type:String,\r\n  \r\n  },\r\n  role:{\r\n    type:String,\r\n    required:true,\r\n    default:'Restricted'\r\n  },\r\n  score:{\r\n    type:Number,\r\n    required:true,\r\n    default:1\r\n  },\r\n  badge: {\r\n    type: String,\r\n    required: true,\r\n    default: 'Level 1 (Contributor)'\r\n  },\r\n  created: {\r\n    type: Date,\r\n    default: Date.now,\r\n  },\r\n  about: {\r\n    type: String,\r\n    trim: true,\r\n  },\r\n  photo: {\r\n    data: Buffer,\r\n    contentType: String,\r\n  },\r\n  following: [{ type: mongoose.Schema.ObjectId, ref: \"User\" }],\r\n  followers: [{ type: mongoose.Schema.ObjectId, ref: \"User\" }],\r\n});\r\n\r\nUserSchema.virtual(\"password\")\r\n  .set(function (password) {\r\n    this._password = password;\r\n    this.salt = this.makeSalt();\r\n    this.hashed_password = this.encryptPassword(password);\r\n  })\r\n  .get(function () {\r\n    return this._password;\r\n  });\r\n\r\nUserSchema.path(\"hashed_password\").validate(function (v) {\r\n  if (this._password && this._password.length < 6) {\r\n    this.invalidate(\"password\", \"Password must be at least 6 characters.\");\r\n  }\r\n  if (this.isNew && !this._password) {\r\n    this.invalidate(\"password\", \"Password is required\");\r\n  }\r\n}, null);\r\n\r\nUserSchema.methods = {\r\n  authenticate: function (plainText) {\r\n    return this.encryptPassword(plainText) === this.hashed_password;\r\n  },\r\n  encryptPassword: function (password) {\r\n    if (!password) return \"\";\r\n    try {\r\n      return crypto\r\n        .createHmac(\"sha1\", this.salt)\r\n        .update(password)\r\n        .digest(\"hex\");\r\n    } catch (err) {\r\n      return \"\";\r\n    }\r\n  },\r\n  makeSalt: function () {\r\n    return Math.round(new Date().valueOf() * Math.random()) + \"\";\r\n  },\r\n};\r\n\r\nmodule.exports = mongoose.model(\"User\", UserSchema);\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d4dd8770ea0cad804d9ea23fba69db2116c04fd8","contentHash":"4cfd93cb8e61ab3bd28ea9e4e7fc51f63e269d20f19ea37aa83ec0d1b55fc324"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\authControllers.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\authControllers.js","statementMap":{"0":{"start":{"line":1,"column":13},"end":{"line":1,"column":38}},"1":{"start":{"line":2,"column":12},"end":{"line":2,"column":35}},"2":{"start":{"line":3,"column":19},"end":{"line":3,"column":41}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":35}},"4":{"start":{"line":6,"column":15},"end":{"line":40,"column":1}},"5":{"start":{"line":7,"column":2},"end":{"line":39,"column":3}},"6":{"start":{"line":8,"column":15},"end":{"line":10,"column":6}},"7":{"start":{"line":12,"column":4},"end":{"line":14,"column":7}},"8":{"start":{"line":12,"column":15},"end":{"line":14,"column":7}},"9":{"start":{"line":16,"column":4},"end":{"line":20,"column":5}},"10":{"start":{"line":17,"column":6},"end":{"line":19,"column":9}},"11":{"start":{"line":22,"column":18},"end":{"line":24,"column":24}},"12":{"start":{"line":26,"column":4},"end":{"line":28,"column":7}},"13":{"start":{"line":30,"column":4},"end":{"line":33,"column":7}},"14":{"start":{"line":35,"column":4},"end":{"line":35,"column":21}},"15":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"16":{"start":{"line":42,"column":16},"end":{"line":47,"column":1}},"17":{"start":{"line":43,"column":2},"end":{"line":43,"column":23}},"18":{"start":{"line":44,"column":2},"end":{"line":46,"column":5}},"19":{"start":{"line":49,"column":22},"end":{"line":62,"column":1}},"20":{"start":{"line":51,"column":20},"end":{"line":51,"column":45}},"21":{"start":{"line":52,"column":2},"end":{"line":52,"column":54}},"22":{"start":{"line":53,"column":17},"end":{"line":53,"column":64}},"23":{"start":{"line":56,"column":2},"end":{"line":56,"column":41}},"24":{"start":{"line":58,"column":2},"end":{"line":61,"column":48}},"25":{"start":{"line":60,"column":4},"end":{"line":60,"column":11}},"26":{"start":{"line":61,"column":9},"end":{"line":61,"column":48}},"27":{"start":{"line":64,"column":25},"end":{"line":75,"column":1}},"28":{"start":{"line":65,"column":13},"end":{"line":65,"column":18}},"29":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"30":{"start":{"line":67,"column":4},"end":{"line":67,"column":16}},"31":{"start":{"line":69,"column":2},"end":{"line":73,"column":3}},"32":{"start":{"line":70,"column":4},"end":{"line":72,"column":7}},"33":{"start":{"line":74,"column":2},"end":{"line":74,"column":9}},"34":{"start":{"line":77,"column":0},"end":{"line":82,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":15},"end":{"line":6,"column":16}},"loc":{"start":{"line":6,"column":35},"end":{"line":40,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":42,"column":16},"end":{"line":42,"column":17}},"loc":{"start":{"line":42,"column":30},"end":{"line":47,"column":1}},"line":42},"2":{"name":"(anonymous_2)","decl":{"start":{"line":49,"column":22},"end":{"line":49,"column":23}},"loc":{"start":{"line":49,"column":48},"end":{"line":62,"column":1}},"line":49},"3":{"name":"(anonymous_3)","decl":{"start":{"line":64,"column":25},"end":{"line":64,"column":26}},"loc":{"start":{"line":64,"column":45},"end":{"line":75,"column":1}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":7}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":7}},{"start":{"line":12,"column":4},"end":{"line":14,"column":7}}],"line":12},"1":{"loc":{"start":{"line":16,"column":4},"end":{"line":20,"column":5}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":20,"column":5}},{"start":{"line":16,"column":4},"end":{"line":20,"column":5}}],"line":16},"2":{"loc":{"start":{"line":58,"column":2},"end":{"line":61,"column":48}},"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":61,"column":48}},{"start":{"line":58,"column":2},"end":{"line":61,"column":48}}],"line":58},"3":{"loc":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"type":"if","locations":[{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},{"start":{"line":66,"column":2},"end":{"line":68,"column":3}}],"line":66},"4":{"loc":{"start":{"line":69,"column":2},"end":{"line":73,"column":3}},"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":73,"column":3}},{"start":{"line":69,"column":2},"end":{"line":73,"column":3}}],"line":69}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":5,"6":5,"7":5,"8":1,"9":4,"10":1,"11":3,"12":3,"13":3,"14":0,"15":0,"16":1,"17":2,"18":2,"19":1,"20":16,"21":16,"22":16,"23":16,"24":16,"25":16,"26":0,"27":1,"28":2,"29":2,"30":2,"31":2,"32":0,"33":2,"34":1},"f":{"0":5,"1":2,"2":16,"3":2},"b":{"0":[1,4],"1":[1,3],"2":[16,0],"3":[2,0],"4":[0,2]},"inputSourceMap":{"version":3,"sources":["authControllers.js"],"names":["User","require","jwt","expressJwt","config","signin","req","res","user","findOne","email","body","status","json","error","authenticate","password","send","token","sign","_id","jwtSecret","cookie","expire","Date","name","err","console","log","signout","clearCookie","message","requireSignin","next","accessToken","headers","authorization","replace","userId","verify","findById","hasAuthorization","auth","String","profile","module","exports"],"mappings":"AAAA,MAAMA,OAAOC,QAAQ,gBAAR,CAAb;AACA,MAAMC,MAAMD,QAAQ,cAAR,CAAZ;AACA,MAAME,aAAaF,QAAQ,aAAR,CAAnB;AACA,MAAMG,SAASH,QAAQ,WAAR,CAAf;;AAEA,MAAMI,SAAS,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAI;AACF,QAAIC,OAAO,MAAMR,KAAKS,OAAL,CAAa;AAC5BC,aAAOJ,IAAIK,IAAJ,CAASD;AADY,KAAb,CAAjB;;AAIA,QAAI,CAACF,IAAL,EACE,OAAOD,IAAIK,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BC,aAAO;AADqB,KAAvB,CAAP;;AAIF,QAAI,CAACN,KAAKO,YAAL,CAAkBT,IAAIK,IAAJ,CAASK,QAA3B,CAAL,EAA2C;AACzC,aAAOT,IAAIK,MAAJ,CAAW,KAAX,EAAkBK,IAAlB,CAAuB;AAC5BH,eAAO;AADqB,OAAvB,CAAP;AAGD;;AAED,UAAMI,QAAQhB,IAAIiB,IAAJ,CACZ;AACEC,WAAKZ,KAAKY;AADZ,KADY,EAIZhB,OAAOiB,SAJK,CAAd;;AAOAd,QAAIe,MAAJ,CAAW,GAAX,EAAgBJ,KAAhB,EAAuB;AACrBK,cAAQ,IAAIC,IAAJ,KAAa;AADA,KAAvB;;AAIA,WAAOjB,IAAIM,IAAJ,CAAS;AACdK,WADc;AAEdV,YAAM,EAAEY,KAAKZ,KAAKY,GAAZ,EAAiBK,MAAMjB,KAAKiB,IAA5B,EAAkCf,OAAOF,KAAKE,KAA9C;AAFQ,KAAT,CAAP;AAID,GA/BD,CA+BE,OAAOgB,GAAP,EAAY;AACZC,YAAQC,GAAR,CAAYF,GAAZ;AACA,WAAOnB,IAAIK,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BC,aAAO;AADqB,KAAvB,CAAP;AAGD;AACF,CAtCD;;AAwCA,MAAMe,UAAU,CAACvB,GAAD,EAAMC,GAAN,KAAc;AAC5BA,MAAIuB,WAAJ,CAAgB,GAAhB;AACA,SAAOvB,IAAIK,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BkB,aAAS;AADmB,GAAvB,CAAP;AAGD,CALD;;AAOA,MAAMC,gBAAgB,OAAM1B,GAAN,EAAUC,GAAV,EAAc0B,IAAd,KAAqB;;AAEvC,MAAIC,cAAa5B,IAAI6B,OAAJ,CAAYC,aAA7B;AACAF,gBAAYA,YAAYG,OAAZ,CAAoB,YAApB,EAAkC,EAAlC,CAAZ;AACA,QAAMC,SAAS,MAAMpC,IAAIqC,MAAJ,CAAWL,WAAX,EAAwB9B,OAAOiB,SAA/B,CAArB;AACA;;AAEAf,MAAIE,IAAJ,GAAW,MAAMR,KAAKwC,QAAL,CAAcF,MAAd,CAAjB;;AAEA,MAAGhC,IAAIE,IAAP,EAAY;;AAEVyB;AACD,GAHD,MAKG1B,IAAIK,MAAJ,CAAW,GAAX,EAAgBK,IAAhB,CAAqB,gBAArB;AAGN,CAjBD;;AAmBA,MAAMwB,mBAAmB,CAACnC,GAAD,EAAMC,GAAN,EAAW0B,IAAX,KAAoB;AAC3C,MAAIS,OAAK,KAAT;AACA,MAAGC,OAAOrC,IAAIsC,OAAJ,CAAYxB,GAAnB,KAA0BuB,OAAOrC,IAAIE,IAAJ,CAASY,GAAhB,CAA7B,EACA;AACGsB,WAAK,IAAL;AACF;AACD,MAAI,CAACA,IAAL,EAAW;AACT,WAAOnC,IAAIK,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BC,aAAO;AADqB,KAAvB,CAAP;AAGD;AACDmB;AACD,CAZD;;AAcAY,OAAOC,OAAP,GAAiB;AACfzC,QADe;AAEfwB,SAFe;AAGfG,eAHe;AAIfS;AAJe,CAAjB","file":"authControllers.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/controllers","sourcesContent":["const User = require(\"../models/user\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst expressJwt = require(\"express-jwt\");\r\nconst config = require(\"../config\");\r\n\r\nconst signin = async (req, res) => {\r\n  try {\r\n    let user = await User.findOne({\r\n      email: req.body.email,\r\n    });\r\n\r\n    if (!user)\r\n      return res.status(\"401\").json({\r\n        error: \"User not found\",\r\n      });\r\n\r\n    if (!user.authenticate(req.body.password)) {\r\n      return res.status(\"401\").send({\r\n        error: \"Email and password don't match.\",\r\n      });\r\n    }\r\n\r\n    const token = jwt.sign(\r\n      {\r\n        _id: user._id,\r\n      },\r\n      config.jwtSecret\r\n    );\r\n\r\n    res.cookie(\"t\", token, {\r\n      expire: new Date() + 9999,\r\n    });\r\n\r\n    return res.json({\r\n      token,\r\n      user: { _id: user._id, name: user.name, email: user.email },\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    return res.status(\"401\").json({\r\n      error: \"Could not sign in\",\r\n    });\r\n  }\r\n};\r\n\r\nconst signout = (req, res) => {\r\n  res.clearCookie(\"t\");\r\n  return res.status(\"200\").json({\r\n    message: \"signed out\",\r\n  });\r\n};\r\n\r\nconst requireSignin = async(req,res,next)=>{\r\n  \r\n    var accessToken =req.headers.authorization\r\n    accessToken=accessToken.replace(/^Bearer\\s+/, \"\");\r\n    const userId = await jwt.verify(accessToken, config.jwtSecret);\r\n    // Check if token has expired\r\n   \r\n    req.user = await User.findById(userId); \r\n  \r\n    if(req.user){\r\n    \r\n      next();\r\n    }\r\n    else\r\n       res.status(401).send(\"Not authorized\")\r\n\r\n   \r\n}\r\n\r\nconst hasAuthorization = (req, res, next) => {\r\n  let auth=false;\r\n  if(String(req.profile._id) ==String(req.user._id))\r\n  {\r\n     auth=true\r\n  }\r\n  if (!auth) {\r\n    return res.status(\"403\").json({\r\n      error: \"User is not authorized\",\r\n    });\r\n  }\r\n  next();\r\n};\r\n\r\nmodule.exports = {\r\n  signin,\r\n  signout,\r\n  requireSignin,\r\n  hasAuthorization,\r\n};\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"52aa531319560cda826e9550398055092f551e0e","contentHash":"8ade5c22adabca74336060e9c583e7a4cac9a3cd7c3a527a4c701209c4465db3"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\lbcontroller.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\lbcontroller.js","statementMap":{"0":{"start":{"line":1,"column":13},"end":{"line":1,"column":38}},"1":{"start":{"line":2,"column":13},"end":{"line":2,"column":38}},"2":{"start":{"line":3,"column":13},"end":{"line":3,"column":38}},"3":{"start":{"line":5,"column":20},"end":{"line":33,"column":1}},"4":{"start":{"line":6,"column":2},"end":{"line":28,"column":5}},"5":{"start":{"line":7,"column":4},"end":{"line":21,"column":7}},"6":{"start":{"line":8,"column":19},"end":{"line":8,"column":32}},"7":{"start":{"line":9,"column":18},"end":{"line":9,"column":35}},"8":{"start":{"line":11,"column":21},"end":{"line":11,"column":41}},"9":{"start":{"line":12,"column":20},"end":{"line":12,"column":30}},"10":{"start":{"line":13,"column":23},"end":{"line":13,"column":53}},"11":{"start":{"line":14,"column":23},"end":{"line":14,"column":66}},"12":{"start":{"line":16,"column":6},"end":{"line":20,"column":9}},"13":{"start":{"line":17,"column":8},"end":{"line":19,"column":9}},"14":{"start":{"line":18,"column":10},"end":{"line":18,"column":27}},"15":{"start":{"line":23,"column":4},"end":{"line":27,"column":5}},"16":{"start":{"line":24,"column":6},"end":{"line":26,"column":9}},"17":{"start":{"line":29,"column":15},"end":{"line":29,"column":28}},"18":{"start":{"line":30,"column":2},"end":{"line":32,"column":5}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":58}},"20":{"start":{"line":31,"column":15},"end":{"line":31,"column":36}},"21":{"start":{"line":31,"column":41},"end":{"line":31,"column":58}},"22":{"start":{"line":35,"column":0},"end":{"line":35,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":20},"end":{"line":5,"column":21}},"loc":{"start":{"line":5,"column":34},"end":{"line":33,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":16},"end":{"line":6,"column":17}},"loc":{"start":{"line":6,"column":37},"end":{"line":22,"column":3}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":18}},"loc":{"start":{"line":7,"column":33},"end":{"line":21,"column":5}},"line":7},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":87},"end":{"line":16,"column":88}},"loc":{"start":{"line":16,"column":108},"end":{"line":20,"column":7}},"line":16},"4":{"name":"(anonymous_4)","decl":{"start":{"line":22,"column":10},"end":{"line":22,"column":11}},"loc":{"start":{"line":22,"column":26},"end":{"line":28,"column":3}},"line":22},"5":{"name":"(anonymous_5)","decl":{"start":{"line":30,"column":32},"end":{"line":30,"column":33}},"loc":{"start":{"line":30,"column":51},"end":{"line":32,"column":3}},"line":30}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":8},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":19,"column":9}},{"start":{"line":17,"column":8},"end":{"line":19,"column":9}}],"line":17},"1":{"loc":{"start":{"line":23,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":27,"column":5}},{"start":{"line":23,"column":4},"end":{"line":27,"column":5}}],"line":23},"2":{"loc":{"start":{"line":31,"column":4},"end":{"line":31,"column":58}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":58}},{"start":{"line":31,"column":4},"end":{"line":31,"column":58}}],"line":31}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":0,"15":1,"16":0,"17":1,"18":1,"19":1,"20":0,"21":1,"22":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"b":{"0":[0,1],"1":[0,1],"2":[0,1]},"inputSourceMap":{"version":3,"sources":["lbcontroller.js"],"names":["Post","require","user","User","leaderboard","req","res","find","err","docs","forEach","data","userid","postedBy","likes","length","comments","date2","Date","diffTime","Math","abs","created","diffDays","ceil","findByIdAndUpdate","$inc","score","errr","doc","console","log","exec","posts","status","json","error","mysort","sort","errrr","result","module","exports"],"mappings":"AAAA,MAAMA,OAAOC,QAAQ,gBAAR,CAAb;AACA,MAAMC,OAAOD,QAAQ,gBAAR,CAAb;AACA,MAAME,OAAOF,QAAQ,gBAAR,CAAb;;AAEA,MAAMG,cAAc,CAACC,GAAD,EAAMC,GAAN,KAAc;AAChCN,OAAKO,IAAL,CAAU,EAAV,EAAc,UAAUC,GAAV,EAAeC,IAAf,EAAqB;AACjCA,SAAKC,OAAL,CAAa,UAAUC,IAAV,EAAgB;AAC3B,UAAIC,SAASD,KAAKE,QAAlB;AACA,UAAIC,QAAQH,KAAKG,KAAL,CAAWC,MAAvB;;AAEA,UAAIC,WAAWL,KAAKK,QAAL,CAAcD,MAA7B;AACA,YAAME,QAAQ,IAAIC,IAAJ,EAAd;AACA,YAAMC,WAAWC,KAAKC,GAAL,CAASJ,QAAQN,KAAKW,OAAtB,CAAjB;AACA,YAAMC,WAAWH,KAAKI,IAAL,CAAUL,YAAY,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAA7B,CAAV,CAAjB;;AAGAhB,WAAKsB,iBAAL,CACEb,MADF,EAEE,EAACc,MAAK,EAAEC,OAAQb,QAAME,QAAP,GAAmBO,QAA5B,EAAN,EAFF,EAGE,UAAUK,IAAV,EAAgBC,GAAhB,EAAqB;AACnB,YAAID,IAAJ,EAAU;AACRE,kBAAQC,GAAR,CAAYvB,GAAZ;AACD;AACF,OAPH;AASD,KAnBD;AAoBD,GArBD,EAqBGwB,IArBH,CAqBQ,CAACxB,GAAD,EAAMyB,KAAN,KAAgB;AACtB,QAAIzB,GAAJ,EAAS;AACP,aAAOF,IAAI4B,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAO5B;AADmB,OAArB,CAAP;AAGD;AACF,GA3BD;AA4BA,MAAI6B,SAAS,EAAEV,OAAO,CAAC,CAAV,EAAb;AACAxB,OAAKI,IAAL,GACG+B,IADH,CACQD,MADR,EAEGL,IAFH,CAEQ,CAACO,KAAD,EAAQC,MAAR,KAAmB;AACvB,QAAID,KAAJ,EAAWT,QAAQC,GAAR,CAAY,OAAZ,EAAX,KACKzB,IAAI6B,IAAJ,CAASK,MAAT;AACN,GALH;AAMD,CApCD;;AAsCAC,OAAOC,OAAP,GAAiB,EAAEtC,WAAF,EAAjB","file":"lbcontroller.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/controllers","sourcesContent":["const Post = require(\"../models/post\");\r\nconst user = require(\"../models/user\");\r\nconst User = require(\"../models/user\");\r\n\r\nconst leaderboard = (req, res) => {\r\n  Post.find({}, function (err, docs) {\r\n    docs.forEach(function (data) {\r\n      var userid = data.postedBy;\r\n      var likes = data.likes.length;\r\n\r\n      var comments = data.comments.length;\r\n      const date2 = new Date();\r\n      const diffTime = Math.abs(date2 - data.created);\r\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n      \r\n      \r\n      User.findByIdAndUpdate(\r\n        userid,\r\n        {$inc:{ score: (likes*comments) / diffDays }},\r\n        function (errr, doc) {\r\n          if (errr) {\r\n            console.log(err);\r\n          }\r\n        }\r\n      );\r\n    });\r\n  }).exec((err, posts) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n  });\r\n  var mysort = { score: -1 };\r\n  User.find()\r\n    .sort(mysort)\r\n    .exec((errrr, result) => {\r\n      if (errrr) console.log(\"error\");\r\n      else res.json(result);\r\n    });\r\n};\r\n\r\nmodule.exports = { leaderboard };\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a0173c91d29dbd802fa023ea2773cca6e0b5fa8","contentHash":"cd1cf0c25641667de1c437060c6228476f2c5d7fd5d95f7b3d8eabdf9b939c7f"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\models\\post.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\models\\post.js","statementMap":{"0":{"start":{"line":1,"column":17},"end":{"line":1,"column":36}},"1":{"start":{"line":3,"column":19},"end":{"line":43,"column":2}},"2":{"start":{"line":45,"column":0},"end":{"line":45,"column":52}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["post.js"],"names":["mongoose","require","PostSchema","Schema","text","type","String","required","title","photo","data","Buffer","contentType","hasphoto","Boolean","likes","ObjectId","ref","score","Number","default","username","comments","created","Date","now","postedBy","incomments","module","exports","model"],"mappings":"AAAA,MAAMA,WAAWC,QAAQ,UAAR,CAAjB;;AAEA,MAAMC,aAAa,IAAIF,SAASG,MAAb,CAAoB;AACrCC,QAAM;AACJC,UAAMC,MADF;AAEJC,cAAU;AAFN,GAD+B;AAKrCC,SAAO;AACLH,UAAMC,MADD;AAELC,cAAU;AAFL,GAL8B;AASrCE,SAAO;AACLC,UAAMC,MADD;AAELC,iBAAaN;AAFR,GAT8B;AAarCO,YAAUC,OAb2B;AAcrCC,SAAO,CAAC,EAAEV,MAAML,SAASG,MAAT,CAAgBa,QAAxB,EAAkCC,KAAK,MAAvC,EAAD,CAd8B;AAerCC,SAAO;AACLb,UAAKc,MADA;AAELC,aAAQ,CAFH;AAGLb,cAAS;AAHJ,GAf8B;AAoBrCc,YAAUf,MApB2B;AAqBrCgB,YAAU,CACR;AACElB,UAAME,MADR;AAEEiB,aAAS,EAAElB,MAAMmB,IAAR,EAAcJ,SAASI,KAAKC,GAA5B,EAFX;AAGEC,cAAU,EAAErB,MAAML,SAASG,MAAT,CAAgBa,QAAxB,EAAkCC,KAAK,MAAvC,EAHZ;AAIEF,WAAM,EAAEV,MAAK,CAAC,EAAEA,MAAML,SAASG,MAAT,CAAgBa,QAAxB,EAAkCC,KAAK,MAAvC,EAAD,CAAP;AACLG,eAAQ;AADH,KAJR;;AAQEO,gBAAY,CACV;AACEvB,YAAME,MADR;AAEEoB,gBAAU,EAAErB,MAAML,SAASG,MAAT,CAAgBa,QAAxB,EAAkCC,KAAK,MAAvC;;AAFZ,KADU;AARd,GADQ,CArB2B;AAuCrCS,YAAU,EAAErB,MAAML,SAASG,MAAT,CAAgBa,QAAxB,EAAkCC,KAAK,MAAvC,EAvC2B;AAwCrCM,WAAS;AACPlB,UAAMmB,IADC;AAEPJ,aAASI,KAAKC;AAFP;AAxC4B,CAApB,CAAnB;;AA8CAG,OAAOC,OAAP,GAAiB7B,SAAS8B,KAAT,CAAe,MAAf,EAAuB5B,UAAvB,CAAjB","file":"post.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/models","sourcesContent":["const mongoose = require(\"mongoose\");\r\n\r\nconst PostSchema = new mongoose.Schema({\r\n  text: {\r\n    type: String,\r\n    required: \"Name is required\",\r\n  },\r\n  title: {\r\n    type: String,\r\n    required: \"Title is required\",\r\n  },\r\n  photo: {\r\n    data: Buffer,\r\n    contentType: String,\r\n  },\r\n  hasphoto: Boolean,\r\n  likes: [{ type: mongoose.Schema.ObjectId, ref: \"User\" }],\r\n  score: {\r\n    type:Number,\r\n    default:1,\r\n    required:true\r\n  },\r\n  username: String,\r\n  comments: [\r\n    {\r\n      text: String,\r\n      created: { type: Date, default: Date.now },\r\n      postedBy: { type: mongoose.Schema.ObjectId, ref: \"User\" },\r\n      likes:{ type:[{ type: mongoose.Schema.ObjectId, ref: \"User\" }],\r\n       default:[]\r\n    },\r\n    \r\n      incomments: [\r\n        {\r\n          text: String,\r\n          postedBy: { type: mongoose.Schema.ObjectId, ref: \"User\" },\r\n        \r\n        },\r\n      ],\r\n    },\r\n  ],\r\n  postedBy: { type: mongoose.Schema.ObjectId, ref: \"User\" },\r\n  created: {\r\n    type: Date,\r\n    default: Date.now,\r\n  },\r\n});\r\n\r\nmodule.exports = mongoose.model(\"Post\", PostSchema);\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d01d13713b894b1b386e67e420043602a59a787e","contentHash":"b9cc677139c3138fe8861d1c49c2a5f264c8dbcbf20c23f14812f883e2bbddbc"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\authroutes.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\authroutes.js","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":17},"end":{"line":2,"column":58}},"2":{"start":{"line":3,"column":17},"end":{"line":3,"column":36}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":31}},"4":{"start":{"line":5,"column":23},"end":{"line":5,"column":70}},"5":{"start":{"line":6,"column":15},"end":{"line":6,"column":35}},"6":{"start":{"line":7,"column":13},"end":{"line":7,"column":38}},"7":{"start":{"line":8,"column":17},"end":{"line":8,"column":36}},"8":{"start":{"line":9,"column":13},"end":{"line":9,"column":38}},"9":{"start":{"line":10,"column":12},"end":{"line":10,"column":35}},"10":{"start":{"line":14,"column":0},"end":{"line":14,"column":65}},"11":{"start":{"line":14,"column":35},"end":{"line":14,"column":63}},"12":{"start":{"line":16,"column":0},"end":{"line":18,"column":3}},"13":{"start":{"line":17,"column":2},"end":{"line":17,"column":17}},"14":{"start":{"line":20,"column":0},"end":{"line":22,"column":3}},"15":{"start":{"line":21,"column":2},"end":{"line":21,"column":16}},"16":{"start":{"line":23,"column":0},"end":{"line":30,"column":4}},"17":{"start":{"line":28,"column":2},"end":{"line":28,"column":24}},"18":{"start":{"line":29,"column":2},"end":{"line":29,"column":33}},"19":{"start":{"line":31,"column":0},"end":{"line":31,"column":93}},"20":{"start":{"line":33,"column":0},"end":{"line":77,"column":3}},"21":{"start":{"line":34,"column":13},"end":{"line":40,"column":3}},"22":{"start":{"line":41,"column":17},"end":{"line":43,"column":4}},"23":{"start":{"line":45,"column":18},"end":{"line":45,"column":32}},"24":{"start":{"line":46,"column":2},"end":{"line":76,"column":3}},"25":{"start":{"line":47,"column":4},"end":{"line":62,"column":7}},"26":{"start":{"line":48,"column":6},"end":{"line":61,"column":7}},"27":{"start":{"line":48,"column":17},"end":{"line":48,"column":36}},"28":{"start":{"line":49,"column":22},"end":{"line":51,"column":28}},"29":{"start":{"line":53,"column":8},"end":{"line":55,"column":11}},"30":{"start":{"line":57,"column":8},"end":{"line":60,"column":11}},"31":{"start":{"line":64,"column":18},"end":{"line":66,"column":24}},"32":{"start":{"line":68,"column":4},"end":{"line":70,"column":7}},"33":{"start":{"line":72,"column":4},"end":{"line":75,"column":7}},"34":{"start":{"line":79,"column":0},"end":{"line":84,"column":3}},"35":{"start":{"line":80,"column":2},"end":{"line":80,"column":23}},"36":{"start":{"line":81,"column":2},"end":{"line":83,"column":5}},"37":{"start":{"line":86,"column":0},"end":{"line":86,"column":51}},"38":{"start":{"line":87,"column":0},"end":{"line":87,"column":52}},"39":{"start":{"line":89,"column":0},"end":{"line":89,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":21},"end":{"line":14,"column":22}},"loc":{"start":{"line":14,"column":35},"end":{"line":14,"column":63}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":23},"end":{"line":16,"column":24}},"loc":{"start":{"line":16,"column":43},"end":{"line":18,"column":1}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":25},"end":{"line":20,"column":26}},"loc":{"start":{"line":20,"column":44},"end":{"line":22,"column":1}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":3},"end":{"line":27,"column":4}},"loc":{"start":{"line":27,"column":55},"end":{"line":30,"column":1}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":33,"column":106},"end":{"line":33,"column":107}},"loc":{"start":{"line":33,"column":132},"end":{"line":77,"column":1}},"line":33},"5":{"name":"(anonymous_5)","decl":{"start":{"line":47,"column":19},"end":{"line":47,"column":20}},"loc":{"start":{"line":47,"column":44},"end":{"line":62,"column":5}},"line":47},"6":{"name":"(anonymous_6)","decl":{"start":{"line":79,"column":22},"end":{"line":79,"column":23}},"loc":{"start":{"line":79,"column":36},"end":{"line":84,"column":1}},"line":79}},"branchMap":{"0":{"loc":{"start":{"line":46,"column":2},"end":{"line":76,"column":3}},"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":76,"column":3}},{"start":{"line":46,"column":2},"end":{"line":76,"column":3}}],"line":46},"1":{"loc":{"start":{"line":48,"column":6},"end":{"line":61,"column":7}},"type":"if","locations":[{"start":{"line":48,"column":6},"end":{"line":61,"column":7}},{"start":{"line":48,"column":6},"end":{"line":61,"column":7}}],"line":48}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":0,"19":1,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":1,"38":1,"39":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"sources":["authroutes.js"],"names":["express","require","authCtrl","passport","router","Router","GoogleStrategy","OAuth2Strategy","config","Post","mongoose","User","jwt","userProfile","get","req","res","send","serializeUser","user","cb","deserializeUser","obj","use","clientID","clientSecret","callbackURL","accessToken","refreshToken","profile","done","authenticate","scope","route","failureRedirect","id","name","email","password","userdata","findOne","userdata2","save","error","result","console","log","token","sign","_id","jwtSecret","cookie","expire","Date","json","clearCookie","status","message","post","signin","signout","module","exports"],"mappings":"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","file":"authroutes.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/routes","sourcesContent":["const express = require(\"express\");\r\nconst authCtrl = require(\"../controllers/authControllers\");\r\nconst passport = require(\"passport\");\r\nconst router = express.Router();\r\nconst GoogleStrategy = require(\"passport-google-oauth\").OAuth2Strategy;\r\nconst config = require(\"../config\");\r\nconst Post = require(\"../models/post\");\r\nconst mongoose = require(\"mongoose\");\r\nconst User = require(\"../models/user\");\r\nconst jwt = require(\"jsonwebtoken\");\r\n\r\nvar userProfile;\r\n\r\nrouter.get(\"/error\", (req, res) => res.send(\"error logging in\"));\r\n\r\npassport.serializeUser(function (user, cb) {\r\n  cb(null, user);\r\n});\r\n\r\npassport.deserializeUser(function (obj, cb) {\r\n  cb(null, obj);\r\n});\r\npassport.use(\r\n  new GoogleStrategy(\r\n    {\r\n      clientID:\r\n        \"789965715216-2sbi4nk44kbaabtsqt7vlddgklieksq9.apps.googleusercontent.com\",\r\n      clientSecret: \"Jtdl2O8dBSJnTUrJ9I6UEBhf\",\r\n      callbackURL: \"https://openforumsocial.herokuapp.com/auth/google/callback\",\r\n    },\r\n    function (accessToken, refreshToken, profile, done) {\r\n      userProfile = profile;\r\n      return done(null, userProfile);\r\n    }\r\n  )\r\n);\r\nrouter.get(\r\n  \"/auth/google\",\r\n  passport.authenticate(\"google\", { scope: [\"profile\", \"email\"] })\r\n);\r\n\r\nrouter\r\n  .route(\"/auth/google/callback\")\r\n  .get(\r\n    passport.authenticate(\"google\", { failureRedirect: \"/error\" }),\r\n    async function (req, res) {\r\n      var user = {\r\n        id: userProfile[\"id\"],\r\n        name: userProfile[\"displayName\"],\r\n\r\n        email: userProfile[\"emails\"][0][\"value\"],\r\n        password: \"Google\",\r\n      };\r\n      let userdata = await User.findOne({\r\n        email: user.email,\r\n      });\r\n\r\n      var userdata2 = new User(user);\r\n      if (!userdata) {\r\n        userdata2.save(function (error, result) {\r\n          if (error) console.log(error);\r\n          else {\r\n            const token = jwt.sign(\r\n              {\r\n                _id: result._id,\r\n              },\r\n              config.jwtSecret\r\n            );\r\n\r\n            res.cookie(\"t\", token, {\r\n              expire: new Date() + 9999,\r\n            });\r\n\r\n            return res.json({\r\n              token,\r\n              user: { _id: result._id, name: result.name, email: result.email },\r\n            });\r\n          }\r\n        });\r\n      }else{\r\n      const token = jwt.sign(\r\n        {\r\n          _id: userdata._id,\r\n        },\r\n        config.jwtSecret\r\n      );\r\n\r\n      res.cookie(\"t\", token, {\r\n        expire: new Date() + 9999,\r\n      });\r\n\r\n      return res.json({\r\n        token,\r\n        user: { _id: userdata._id, name: userdata.name, email: userdata.email },\r\n      });\r\n    }}\r\n  );\r\n\r\nrouter.get(\"/logout\", (req, res) => {\r\n  res.clearCookie(\"t\");\r\n  return res.status(\"200\").json({\r\n    message: \"signed out\",\r\n  });\r\n});\r\n\r\nrouter.route(\"/auth/signin\").post(authCtrl.signin);\r\nrouter.route(\"/auth/signout\").get(authCtrl.signout);\r\n\r\nmodule.exports = router;\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f52e1a8b4d1f8bbe205c830325fb1224a6f8aba5","contentHash":"9569afa3a63967e56426069067d616e155424702725ce47c5f89ea9137db6a0d"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\postroutes.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\routes\\postroutes.js","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":17},"end":{"line":2,"column":58}},"2":{"start":{"line":3,"column":17},"end":{"line":3,"column":58}},"3":{"start":{"line":4,"column":17},"end":{"line":4,"column":58}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":31}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":85}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":61}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":87}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":91}},"9":{"start":{"line":16,"column":0},"end":{"line":16,"column":75}},"10":{"start":{"line":17,"column":0},"end":{"line":17,"column":79}},"11":{"start":{"line":19,"column":0},"end":{"line":19,"column":81}},"12":{"start":{"line":20,"column":0},"end":{"line":20,"column":85}},"13":{"start":{"line":22,"column":0},"end":{"line":22,"column":102}},"14":{"start":{"line":24,"column":0},"end":{"line":24,"column":66}},"15":{"start":{"line":25,"column":0},"end":{"line":25,"column":70}},"16":{"start":{"line":27,"column":0},"end":{"line":27,"column":74}},"17":{"start":{"line":28,"column":0},"end":{"line":28,"column":78}},"18":{"start":{"line":30,"column":0},"end":{"line":30,"column":59}},"19":{"start":{"line":32,"column":0},"end":{"line":32,"column":42}},"20":{"start":{"line":33,"column":0},"end":{"line":33,"column":42}},"21":{"start":{"line":35,"column":0},"end":{"line":35,"column":24}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["postroutes.js"],"names":["express","require","userCtrl","authCtrl","postCtrl","router","Router","route","post","requireSignin","create","get","photo","listByUser","listNewsFeed","put","like","unlike","comment","uncomment","delete","isPoster","remove","likeacomment","unlikeacomment","commentincomment","uncommentincomment","trendingposts","param","userByID","postByID","module","exports"],"mappings":"AAAA,MAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,MAAMC,WAAWD,QAAQ,gCAAR,CAAjB;AACA,MAAME,WAASF,QAAQ,gCAAR,CAAf;AACA,MAAMG,WAAWH,QAAQ,gCAAR,CAAjB;;AAEA,MAAMI,SAASL,QAAQM,MAAR,EAAf;;AAEAD,OACGE,KADH,CACS,wBADT,EAEGC,IAFH,CAEQL,SAASM,aAFjB,EAEgCL,SAASM,MAFzC;;AAIAL,OAAOE,KAAP,CAAa,0BAAb,EAAyCI,GAAzC,CAA6CP,SAASQ,KAAtD;;AAEAP,OACGE,KADH,CACS,uBADT,EAEGI,GAFH,CAEOR,SAASM,aAFhB,EAE+BL,SAASS,UAFxC;;AAIAR,OACGE,KADH,CACS,yBADT,EAEGI,GAFH,CAEOR,SAASM,aAFhB,EAE+BL,SAASU,YAFxC;;AAIAT,OAAOE,KAAP,CAAa,iBAAb,EAAgCQ,GAAhC,CAAoCZ,SAASM,aAA7C,EAA4DL,SAASY,IAArE;AACAX,OAAOE,KAAP,CAAa,mBAAb,EAAkCQ,GAAlC,CAAsCZ,SAASM,aAA/C,EAA8DL,SAASa,MAAvE;;AAEAZ,OACGE,KADH,CACS,oBADT,EAEGQ,GAFH,CAEOZ,SAASM,aAFhB,EAE+BL,SAASc,OAFxC;AAGAb,OACGE,KADH,CACS,sBADT,EAEGQ,GAFH,CAEOZ,SAASM,aAFhB,EAE+BL,SAASe,SAFxC;;AAIAd,OACGE,KADH,CACS,oBADT,EAEGa,MAFH,CAEUjB,SAASM,aAFnB,EAEkCL,SAASiB,QAF3C,EAEqDjB,SAASkB,MAF9D;;AAIAjB,OAAOE,KAAP,CAAa,wBAAb,EAAuCQ,GAAvC,CAA2CX,SAASmB,YAApD;AACAlB,OAAOE,KAAP,CAAa,0BAAb,EAAyCQ,GAAzC,CAA6CX,SAASoB,cAAtD;;AAEAnB,OAAOE,KAAP,CAAa,4BAAb,EAA2CQ,GAA3C,CAA+CX,SAASqB,gBAAxD;AACApB,OAAOE,KAAP,CAAa,8BAAb,EAA6CQ,GAA7C,CAAiDX,SAASsB,kBAA1D;;AAEArB,OAAOE,KAAP,CAAa,gBAAb,EAA+BI,GAA/B,CAAmCP,SAASuB,aAA5C;;AAEAtB,OAAOuB,KAAP,CAAa,QAAb,EAAuB1B,SAAS2B,QAAhC;AACAxB,OAAOuB,KAAP,CAAa,QAAb,EAAuBxB,SAAS0B,QAAhC;;AAEAC,OAAOC,OAAP,GAAiB3B,MAAjB","file":"postroutes.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/routes","sourcesContent":["const express = require(\"express\");\r\nconst userCtrl = require(\"../controllers/userControllers\");\r\nconst authCtrl=require('../controllers/authControllers')\r\nconst postCtrl = require(\"../controllers/postControllers\");\r\n\r\nconst router = express.Router();\r\n\r\nrouter\r\n  .route(\"/api/posts/new/:userId\")\r\n  .post(authCtrl.requireSignin, postCtrl.create);\r\n\r\nrouter.route(\"/api/posts/photo/:postId\").get(postCtrl.photo);\r\n\r\nrouter\r\n  .route(\"/api/posts/by/:userId\")\r\n  .get(authCtrl.requireSignin, postCtrl.listByUser);\r\n\r\nrouter\r\n  .route(\"/api/posts/feed/:userId\")\r\n  .get(authCtrl.requireSignin, postCtrl.listNewsFeed);\r\n\r\nrouter.route(\"/api/posts/like\").put(authCtrl.requireSignin, postCtrl.like);\r\nrouter.route(\"/api/posts/unlike\").put(authCtrl.requireSignin, postCtrl.unlike);\r\n\r\nrouter\r\n  .route(\"/api/posts/comment\")\r\n  .put(authCtrl.requireSignin, postCtrl.comment);\r\nrouter\r\n  .route(\"/api/posts/uncomment\")\r\n  .put(authCtrl.requireSignin, postCtrl.uncomment);\r\n\r\nrouter\r\n  .route(\"/api/posts/:postId\")\r\n  .delete(authCtrl.requireSignin, postCtrl.isPoster, postCtrl.remove);\r\n\r\nrouter.route(\"/api/post/likeacomment\").put(postCtrl.likeacomment)\r\nrouter.route(\"/api/post/unlikeacomment\").put(postCtrl.unlikeacomment)\r\n\r\nrouter.route(\"/api/post/commentincomment\").put(postCtrl.commentincomment)\r\nrouter.route(\"/api/post/uncommentincomment\").put(postCtrl.uncommentincomment)\r\n\r\nrouter.route(\"/trendingposts\").get(postCtrl.trendingposts)\r\n\r\nrouter.param(\"userId\", userCtrl.userByID);\r\nrouter.param(\"postId\", postCtrl.postByID);\r\n\r\nmodule.exports = router;\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e328a1f986a8162c12591d0267d5e3253b09ce4","contentHash":"435ece30b4e117ea071b9d3aa0f5039215d823ccd9fa7ca973b10b922ed9d9c1"},"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\postControllers.js":{"path":"E:\\Sublime Text 2\\Codes\\OpenForum-Project\\controllers\\postControllers.js","statementMap":{"0":{"start":{"line":1,"column":13},"end":{"line":1,"column":38}},"1":{"start":{"line":2,"column":13},"end":{"line":2,"column":38}},"2":{"start":{"line":3,"column":11},"end":{"line":3,"column":24}},"3":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"4":{"start":{"line":5,"column":16},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":17},"end":{"line":6,"column":36}},"6":{"start":{"line":8,"column":15},"end":{"line":35,"column":1}},"7":{"start":{"line":9,"column":13},"end":{"line":9,"column":42}},"8":{"start":{"line":10,"column":2},"end":{"line":10,"column":29}},"9":{"start":{"line":11,"column":2},"end":{"line":34,"column":5}},"10":{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},"11":{"start":{"line":13,"column":6},"end":{"line":15,"column":9}},"12":{"start":{"line":17,"column":15},"end":{"line":17,"column":31}},"13":{"start":{"line":18,"column":4},"end":{"line":18,"column":32}},"14":{"start":{"line":19,"column":4},"end":{"line":19,"column":45}},"15":{"start":{"line":20,"column":4},"end":{"line":24,"column":29}},"16":{"start":{"line":21,"column":6},"end":{"line":21,"column":58}},"17":{"start":{"line":22,"column":6},"end":{"line":22,"column":48}},"18":{"start":{"line":23,"column":6},"end":{"line":23,"column":24}},"19":{"start":{"line":24,"column":11},"end":{"line":24,"column":29}},"20":{"start":{"line":25,"column":4},"end":{"line":33,"column":7}},"21":{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},"22":{"start":{"line":27,"column":8},"end":{"line":29,"column":11}},"23":{"start":{"line":31,"column":6},"end":{"line":31,"column":38}},"24":{"start":{"line":32,"column":6},"end":{"line":32,"column":23}},"25":{"start":{"line":37,"column":17},"end":{"line":45,"column":1}},"26":{"start":{"line":38,"column":2},"end":{"line":44,"column":5}},"27":{"start":{"line":39,"column":4},"end":{"line":41,"column":7}},"28":{"start":{"line":39,"column":22},"end":{"line":41,"column":7}},"29":{"start":{"line":42,"column":4},"end":{"line":42,"column":20}},"30":{"start":{"line":43,"column":4},"end":{"line":43,"column":11}},"31":{"start":{"line":47,"column":19},"end":{"line":56,"column":1}},"32":{"start":{"line":48,"column":2},"end":{"line":55,"column":5}},"33":{"start":{"line":49,"column":4},"end":{"line":53,"column":5}},"34":{"start":{"line":50,"column":6},"end":{"line":52,"column":9}},"35":{"start":{"line":54,"column":4},"end":{"line":54,"column":20}},"36":{"start":{"line":58,"column":21},"end":{"line":69,"column":1}},"37":{"start":{"line":59,"column":18},"end":{"line":59,"column":39}},"38":{"start":{"line":60,"column":2},"end":{"line":60,"column":34}},"39":{"start":{"line":61,"column":2},"end":{"line":68,"column":5}},"40":{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},"41":{"start":{"line":63,"column":6},"end":{"line":65,"column":9}},"42":{"start":{"line":67,"column":4},"end":{"line":67,"column":20}},"43":{"start":{"line":71,"column":15},"end":{"line":81,"column":1}},"44":{"start":{"line":72,"column":13},"end":{"line":72,"column":21}},"45":{"start":{"line":73,"column":2},"end":{"line":80,"column":5}},"46":{"start":{"line":74,"column":4},"end":{"line":78,"column":5}},"47":{"start":{"line":75,"column":6},"end":{"line":77,"column":9}},"48":{"start":{"line":79,"column":4},"end":{"line":79,"column":26}},"49":{"start":{"line":83,"column":14},"end":{"line":86,"column":1}},"50":{"start":{"line":84,"column":2},"end":{"line":84,"column":54}},"51":{"start":{"line":85,"column":2},"end":{"line":85,"column":39}},"52":{"start":{"line":88,"column":13},"end":{"line":97,"column":1}},"53":{"start":{"line":89,"column":2},"end":{"line":96,"column":5}},"54":{"start":{"line":90,"column":4},"end":{"line":94,"column":5}},"55":{"start":{"line":91,"column":6},"end":{"line":93,"column":9}},"56":{"start":{"line":95,"column":4},"end":{"line":95,"column":21}},"57":{"start":{"line":99,"column":15},"end":{"line":108,"column":1}},"58":{"start":{"line":100,"column":2},"end":{"line":107,"column":5}},"59":{"start":{"line":101,"column":4},"end":{"line":105,"column":5}},"60":{"start":{"line":102,"column":6},"end":{"line":104,"column":9}},"61":{"start":{"line":106,"column":4},"end":{"line":106,"column":21}},"62":{"start":{"line":110,"column":21},"end":{"line":124,"column":1}},"63":{"start":{"line":112,"column":2},"end":{"line":123,"column":5}},"64":{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},"65":{"start":{"line":118,"column":6},"end":{"line":120,"column":9}},"66":{"start":{"line":122,"column":4},"end":{"line":122,"column":21}},"67":{"start":{"line":126,"column":23},"end":{"line":139,"column":1}},"68":{"start":{"line":127,"column":2},"end":{"line":138,"column":5}},"69":{"start":{"line":132,"column":4},"end":{"line":136,"column":5}},"70":{"start":{"line":133,"column":6},"end":{"line":135,"column":9}},"71":{"start":{"line":137,"column":4},"end":{"line":137,"column":21}},"72":{"start":{"line":141,"column":25},"end":{"line":156,"column":1}},"73":{"start":{"line":142,"column":16},"end":{"line":146,"column":3}},"74":{"start":{"line":147,"column":2},"end":{"line":155,"column":5}},"75":{"start":{"line":148,"column":4},"end":{"line":152,"column":5}},"76":{"start":{"line":149,"column":6},"end":{"line":151,"column":9}},"77":{"start":{"line":153,"column":4},"end":{"line":153,"column":36}},"78":{"start":{"line":154,"column":4},"end":{"line":154,"column":21}},"79":{"start":{"line":157,"column":27},"end":{"line":172,"column":1}},"80":{"start":{"line":158,"column":16},"end":{"line":162,"column":3}},"81":{"start":{"line":163,"column":2},"end":{"line":171,"column":5}},"82":{"start":{"line":164,"column":4},"end":{"line":168,"column":5}},"83":{"start":{"line":165,"column":6},"end":{"line":167,"column":9}},"84":{"start":{"line":169,"column":4},"end":{"line":169,"column":36}},"85":{"start":{"line":170,"column":4},"end":{"line":170,"column":21}},"86":{"start":{"line":174,"column":16},"end":{"line":191,"column":1}},"87":{"start":{"line":175,"column":17},"end":{"line":180,"column":3}},"88":{"start":{"line":182,"column":2},"end":{"line":190,"column":5}},"89":{"start":{"line":183,"column":4},"end":{"line":187,"column":5}},"90":{"start":{"line":184,"column":6},"end":{"line":186,"column":9}},"91":{"start":{"line":189,"column":4},"end":{"line":189,"column":21}},"92":{"start":{"line":192,"column":18},"end":{"line":202,"column":1}},"93":{"start":{"line":193,"column":16},"end":{"line":193,"column":32}},"94":{"start":{"line":194,"column":2},"end":{"line":201,"column":5}},"95":{"start":{"line":195,"column":4},"end":{"line":199,"column":5}},"96":{"start":{"line":196,"column":6},"end":{"line":198,"column":9}},"97":{"start":{"line":200,"column":4},"end":{"line":200,"column":21}},"98":{"start":{"line":204,"column":17},"end":{"line":214,"column":1}},"99":{"start":{"line":205,"column":17},"end":{"line":205,"column":71}},"100":{"start":{"line":206,"column":22},"end":{"line":206,"column":46}},"101":{"start":{"line":207,"column":2},"end":{"line":213,"column":3}},"102":{"start":{"line":208,"column":4},"end":{"line":208,"column":11}},"103":{"start":{"line":210,"column":4},"end":{"line":212,"column":7}},"104":{"start":{"line":216,"column":20},"end":{"line":222,"column":1}},"105":{"start":{"line":217,"column":2},"end":{"line":221,"column":5}},"106":{"start":{"line":218,"column":4},"end":{"line":220,"column":5}},"107":{"start":{"line":219,"column":6},"end":{"line":219,"column":17}},"108":{"start":{"line":224,"column":22},"end":{"line":250,"column":1}},"109":{"start":{"line":225,"column":2},"end":{"line":245,"column":5}},"110":{"start":{"line":226,"column":4},"end":{"line":226,"column":47}},"111":{"start":{"line":226,"column":26},"end":{"line":226,"column":47}},"112":{"start":{"line":227,"column":4},"end":{"line":240,"column":7}},"113":{"start":{"line":228,"column":15},"end":{"line":228,"column":22}},"114":{"start":{"line":229,"column":18},"end":{"line":229,"column":35}},"115":{"start":{"line":231,"column":21},"end":{"line":231,"column":41}},"116":{"start":{"line":232,"column":20},"end":{"line":232,"column":30}},"117":{"start":{"line":233,"column":23},"end":{"line":233,"column":53}},"118":{"start":{"line":234,"column":23},"end":{"line":234,"column":66}},"119":{"start":{"line":235,"column":6},"end":{"line":239,"column":9}},"120":{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},"121":{"start":{"line":237,"column":10},"end":{"line":237,"column":27}},"122":{"start":{"line":242,"column":4},"end":{"line":244,"column":5}},"123":{"start":{"line":243,"column":6},"end":{"line":243,"column":23}},"124":{"start":{"line":246,"column":15},"end":{"line":246,"column":28}},"125":{"start":{"line":247,"column":2},"end":{"line":249,"column":5}},"126":{"start":{"line":248,"column":4},"end":{"line":248,"column":47}},"127":{"start":{"line":248,"column":12},"end":{"line":248,"column":25}},"128":{"start":{"line":248,"column":30},"end":{"line":248,"column":47}},"129":{"start":{"line":252,"column":0},"end":{"line":269,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":15},"end":{"line":8,"column":16}},"loc":{"start":{"line":8,"column":35},"end":{"line":35,"column":1}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":18},"end":{"line":11,"column":19}},"loc":{"start":{"line":11,"column":42},"end":{"line":34,"column":3}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":25,"column":14},"end":{"line":25,"column":15}},"loc":{"start":{"line":25,"column":31},"end":{"line":33,"column":5}},"line":25},"3":{"name":"(anonymous_3)","decl":{"start":{"line":37,"column":17},"end":{"line":37,"column":18}},"loc":{"start":{"line":37,"column":41},"end":{"line":45,"column":1}},"line":37},"4":{"name":"(anonymous_4)","decl":{"start":{"line":38,"column":144},"end":{"line":38,"column":145}},"loc":{"start":{"line":38,"column":159},"end":{"line":44,"column":3}},"line":38},"5":{"name":"(anonymous_5)","decl":{"start":{"line":47,"column":19},"end":{"line":47,"column":20}},"loc":{"start":{"line":47,"column":33},"end":{"line":56,"column":1}},"line":47},"6":{"name":"(anonymous_6)","decl":{"start":{"line":48,"column":263},"end":{"line":48,"column":264}},"loc":{"start":{"line":48,"column":279},"end":{"line":55,"column":3}},"line":48},"7":{"name":"(anonymous_7)","decl":{"start":{"line":58,"column":21},"end":{"line":58,"column":22}},"loc":{"start":{"line":58,"column":35},"end":{"line":69,"column":1}},"line":58},"8":{"name":"(anonymous_8)","decl":{"start":{"line":61,"column":278},"end":{"line":61,"column":279}},"loc":{"start":{"line":61,"column":294},"end":{"line":68,"column":3}},"line":61},"9":{"name":"(anonymous_9)","decl":{"start":{"line":71,"column":15},"end":{"line":71,"column":16}},"loc":{"start":{"line":71,"column":29},"end":{"line":81,"column":1}},"line":71},"10":{"name":"(anonymous_10)","decl":{"start":{"line":73,"column":14},"end":{"line":73,"column":15}},"loc":{"start":{"line":73,"column":36},"end":{"line":80,"column":3}},"line":73},"11":{"name":"(anonymous_11)","decl":{"start":{"line":83,"column":14},"end":{"line":83,"column":15}},"loc":{"start":{"line":83,"column":34},"end":{"line":86,"column":1}},"line":83},"12":{"name":"(anonymous_12)","decl":{"start":{"line":88,"column":13},"end":{"line":88,"column":14}},"loc":{"start":{"line":88,"column":27},"end":{"line":97,"column":1}},"line":88},"13":{"name":"(anonymous_13)","decl":{"start":{"line":89,"column":101},"end":{"line":89,"column":102}},"loc":{"start":{"line":89,"column":118},"end":{"line":96,"column":3}},"line":89},"14":{"name":"(anonymous_14)","decl":{"start":{"line":99,"column":15},"end":{"line":99,"column":16}},"loc":{"start":{"line":99,"column":29},"end":{"line":108,"column":1}},"line":99},"15":{"name":"(anonymous_15)","decl":{"start":{"line":100,"column":101},"end":{"line":100,"column":102}},"loc":{"start":{"line":100,"column":118},"end":{"line":107,"column":3}},"line":100},"16":{"name":"(anonymous_16)","decl":{"start":{"line":110,"column":21},"end":{"line":110,"column":22}},"loc":{"start":{"line":110,"column":35},"end":{"line":124,"column":1}},"line":110},"17":{"name":"(anonymous_17)","decl":{"start":{"line":116,"column":62},"end":{"line":116,"column":63}},"loc":{"start":{"line":116,"column":79},"end":{"line":123,"column":3}},"line":116},"18":{"name":"(anonymous_18)","decl":{"start":{"line":126,"column":23},"end":{"line":126,"column":24}},"loc":{"start":{"line":126,"column":37},"end":{"line":139,"column":1}},"line":126},"19":{"name":"(anonymous_19)","decl":{"start":{"line":131,"column":62},"end":{"line":131,"column":63}},"loc":{"start":{"line":131,"column":79},"end":{"line":138,"column":3}},"line":131},"20":{"name":"(anonymous_20)","decl":{"start":{"line":141,"column":25},"end":{"line":141,"column":26}},"loc":{"start":{"line":141,"column":39},"end":{"line":156,"column":1}},"line":141},"21":{"name":"(anonymous_21)","decl":{"start":{"line":147,"column":154},"end":{"line":147,"column":155}},"loc":{"start":{"line":147,"column":171},"end":{"line":155,"column":3}},"line":147},"22":{"name":"(anonymous_22)","decl":{"start":{"line":157,"column":27},"end":{"line":157,"column":28}},"loc":{"start":{"line":157,"column":41},"end":{"line":172,"column":1}},"line":157},"23":{"name":"(anonymous_23)","decl":{"start":{"line":163,"column":154},"end":{"line":163,"column":155}},"loc":{"start":{"line":163,"column":171},"end":{"line":171,"column":3}},"line":163},"24":{"name":"(anonymous_24)","decl":{"start":{"line":174,"column":16},"end":{"line":174,"column":17}},"loc":{"start":{"line":174,"column":30},"end":{"line":191,"column":1}},"line":174},"25":{"name":"(anonymous_25)","decl":{"start":{"line":182,"column":148},"end":{"line":182,"column":149}},"loc":{"start":{"line":182,"column":165},"end":{"line":190,"column":3}},"line":182},"26":{"name":"(anonymous_26)","decl":{"start":{"line":192,"column":18},"end":{"line":192,"column":19}},"loc":{"start":{"line":192,"column":32},"end":{"line":202,"column":1}},"line":192},"27":{"name":"(anonymous_27)","decl":{"start":{"line":194,"column":184},"end":{"line":194,"column":185}},"loc":{"start":{"line":194,"column":201},"end":{"line":201,"column":3}},"line":194},"28":{"name":"(anonymous_28)","decl":{"start":{"line":204,"column":17},"end":{"line":204,"column":18}},"loc":{"start":{"line":204,"column":37},"end":{"line":214,"column":1}},"line":204},"29":{"name":"(anonymous_29)","decl":{"start":{"line":216,"column":20},"end":{"line":216,"column":21}},"loc":{"start":{"line":216,"column":40},"end":{"line":222,"column":1}},"line":216},"30":{"name":"(anonymous_30)","decl":{"start":{"line":217,"column":75},"end":{"line":217,"column":76}},"loc":{"start":{"line":217,"column":92},"end":{"line":221,"column":3}},"line":217},"31":{"name":"(anonymous_31)","decl":{"start":{"line":224,"column":22},"end":{"line":224,"column":23}},"loc":{"start":{"line":224,"column":36},"end":{"line":250,"column":1}},"line":224},"32":{"name":"(anonymous_32)","decl":{"start":{"line":225,"column":16},"end":{"line":225,"column":17}},"loc":{"start":{"line":225,"column":37},"end":{"line":241,"column":3}},"line":225},"33":{"name":"(anonymous_33)","decl":{"start":{"line":227,"column":17},"end":{"line":227,"column":18}},"loc":{"start":{"line":227,"column":33},"end":{"line":240,"column":5}},"line":227},"34":{"name":"(anonymous_34)","decl":{"start":{"line":235,"column":83},"end":{"line":235,"column":84}},"loc":{"start":{"line":235,"column":104},"end":{"line":239,"column":7}},"line":235},"35":{"name":"(anonymous_35)","decl":{"start":{"line":241,"column":10},"end":{"line":241,"column":11}},"loc":{"start":{"line":241,"column":26},"end":{"line":245,"column":3}},"line":241},"36":{"name":"(anonymous_36)","decl":{"start":{"line":247,"column":153},"end":{"line":247,"column":154}},"loc":{"start":{"line":247,"column":169},"end":{"line":249,"column":3}},"line":247}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},{"start":{"line":12,"column":4},"end":{"line":16,"column":5}}],"line":12},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":24,"column":29}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":24,"column":29}},{"start":{"line":20,"column":4},"end":{"line":24,"column":29}}],"line":20},"2":{"loc":{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":30,"column":7}},{"start":{"line":26,"column":6},"end":{"line":30,"column":7}}],"line":26},"3":{"loc":{"start":{"line":39,"column":4},"end":{"line":41,"column":7}},"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":41,"column":7}},{"start":{"line":39,"column":4},"end":{"line":41,"column":7}}],"line":39},"4":{"loc":{"start":{"line":39,"column":8},"end":{"line":39,"column":20}},"type":"binary-expr","locations":[{"start":{"line":39,"column":8},"end":{"line":39,"column":11}},{"start":{"line":39,"column":15},"end":{"line":39,"column":20}}],"line":39},"5":{"loc":{"start":{"line":49,"column":4},"end":{"line":53,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":53,"column":5}},{"start":{"line":49,"column":4},"end":{"line":53,"column":5}}],"line":49},"6":{"loc":{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},{"start":{"line":62,"column":4},"end":{"line":66,"column":5}}],"line":62},"7":{"loc":{"start":{"line":74,"column":4},"end":{"line":78,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":78,"column":5}},{"start":{"line":74,"column":4},"end":{"line":78,"column":5}}],"line":74},"8":{"loc":{"start":{"line":90,"column":4},"end":{"line":94,"column":5}},"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":94,"column":5}},{"start":{"line":90,"column":4},"end":{"line":94,"column":5}}],"line":90},"9":{"loc":{"start":{"line":101,"column":4},"end":{"line":105,"column":5}},"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":105,"column":5}},{"start":{"line":101,"column":4},"end":{"line":105,"column":5}}],"line":101},"10":{"loc":{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},{"start":{"line":117,"column":4},"end":{"line":121,"column":5}}],"line":117},"11":{"loc":{"start":{"line":132,"column":4},"end":{"line":136,"column":5}},"type":"if","locations":[{"start":{"line":132,"column":4},"end":{"line":136,"column":5}},{"start":{"line":132,"column":4},"end":{"line":136,"column":5}}],"line":132},"12":{"loc":{"start":{"line":148,"column":4},"end":{"line":152,"column":5}},"type":"if","locations":[{"start":{"line":148,"column":4},"end":{"line":152,"column":5}},{"start":{"line":148,"column":4},"end":{"line":152,"column":5}}],"line":148},"13":{"loc":{"start":{"line":164,"column":4},"end":{"line":168,"column":5}},"type":"if","locations":[{"start":{"line":164,"column":4},"end":{"line":168,"column":5}},{"start":{"line":164,"column":4},"end":{"line":168,"column":5}}],"line":164},"14":{"loc":{"start":{"line":183,"column":4},"end":{"line":187,"column":5}},"type":"if","locations":[{"start":{"line":183,"column":4},"end":{"line":187,"column":5}},{"start":{"line":183,"column":4},"end":{"line":187,"column":5}}],"line":183},"15":{"loc":{"start":{"line":195,"column":4},"end":{"line":199,"column":5}},"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":199,"column":5}},{"start":{"line":195,"column":4},"end":{"line":199,"column":5}}],"line":195},"16":{"loc":{"start":{"line":207,"column":2},"end":{"line":213,"column":3}},"type":"if","locations":[{"start":{"line":207,"column":2},"end":{"line":213,"column":3}},{"start":{"line":207,"column":2},"end":{"line":213,"column":3}}],"line":207},"17":{"loc":{"start":{"line":207,"column":6},"end":{"line":207,"column":31}},"type":"binary-expr","locations":[{"start":{"line":207,"column":6},"end":{"line":207,"column":14}},{"start":{"line":207,"column":18},"end":{"line":207,"column":31}}],"line":207},"18":{"loc":{"start":{"line":218,"column":4},"end":{"line":220,"column":5}},"type":"if","locations":[{"start":{"line":218,"column":4},"end":{"line":220,"column":5}},{"start":{"line":218,"column":4},"end":{"line":220,"column":5}}],"line":218},"19":{"loc":{"start":{"line":226,"column":4},"end":{"line":226,"column":47}},"type":"if","locations":[{"start":{"line":226,"column":4},"end":{"line":226,"column":47}},{"start":{"line":226,"column":4},"end":{"line":226,"column":47}}],"line":226},"20":{"loc":{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},"type":"if","locations":[{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},{"start":{"line":236,"column":8},"end":{"line":238,"column":9}}],"line":236},"21":{"loc":{"start":{"line":242,"column":4},"end":{"line":244,"column":5}},"type":"if","locations":[{"start":{"line":242,"column":4},"end":{"line":244,"column":5}},{"start":{"line":242,"column":4},"end":{"line":244,"column":5}}],"line":242},"22":{"loc":{"start":{"line":248,"column":4},"end":{"line":248,"column":47}},"type":"if","locations":[{"start":{"line":248,"column":4},"end":{"line":248,"column":47}},{"start":{"line":248,"column":4},"end":{"line":248,"column":47}}],"line":248}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":3,"8":3,"9":3,"10":3,"11":0,"12":3,"13":3,"14":3,"15":3,"16":0,"17":0,"18":0,"19":3,"20":3,"21":3,"22":2,"23":1,"24":1,"25":1,"26":2,"27":2,"28":0,"29":2,"30":2,"31":1,"32":1,"33":1,"34":0,"35":1,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":1,"45":1,"46":1,"47":0,"48":1,"49":1,"50":0,"51":0,"52":1,"53":1,"54":1,"55":0,"56":1,"57":1,"58":1,"59":1,"60":0,"61":1,"62":1,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":1,"88":1,"89":1,"90":0,"91":1,"92":1,"93":0,"94":0,"95":0,"96":0,"97":0,"98":1,"99":2,"100":2,"101":2,"102":1,"103":1,"104":1,"105":1,"106":1,"107":0,"108":1,"109":1,"110":1,"111":0,"112":1,"113":1,"114":1,"115":1,"116":1,"117":1,"118":1,"119":1,"120":1,"121":0,"122":1,"123":0,"124":1,"125":1,"126":1,"127":0,"128":1,"129":1},"f":{"0":3,"1":3,"2":3,"3":2,"4":2,"5":1,"6":1,"7":0,"8":0,"9":1,"10":1,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":0,"27":0,"28":2,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1},"b":{"0":[0,3],"1":[0,3],"2":[2,1],"3":[0,2],"4":[2,2],"5":[0,1],"6":[0,0],"7":[0,1],"8":[0,1],"9":[0,1],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,1],"15":[0,0],"16":[1,1],"17":[2,1],"18":[0,1],"19":[0,1],"20":[0,1],"21":[0,1],"22":[0,1]},"inputSourceMap":{"version":3,"sources":["postControllers.js"],"names":["Post","require","User","fs","formidable","session","passport","create","req","res","next","form","IncomingForm","keepExtensions","parse","err","fields","files","status","json","error","post","postedBy","profile","username","String","name","photo","data","readFileSync","path","contentType","type","hasphoto","save","result","updateScore","_id","postByID","id","findById","populate","exec","listByUser","find","sort","posts","listNewsFeed","following","push","$in","remove","deletedPost","set","send","like","findByIdAndUpdate","body","postId","$push","likes","userId","new","unlike","$pull","likeacomment","findOneAndUpdate","comment","unlikeacomment","commentincomment","changes","text","comtext","uncommentincomment","commentf","comments","uncomment","isPoster","user","isPosteradmin","role","points","$mul","score","trendingposts","docs","length","forEach","date2","Date","diffTime","Math","abs","created","diffDays","ceil","$inc","errr","doc","console","log","mysort","er","module","exports"],"mappings":"AAAA,MAAMA,OAAOC,QAAQ,gBAAR,CAAb;AACA,MAAMC,OAAOD,QAAQ,gBAAR,CAAb;AACA,MAAME,KAAKF,QAAQ,IAAR,CAAX;AACA,MAAMG,aAAaH,QAAQ,YAAR,CAAnB;AACA,MAAMI,UAAUJ,QAAQ,iBAAR,CAAhB;AACA,MAAMK,WAAWL,QAAQ,UAAR,CAAjB;;AAEA,MAAMM,SAAS,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACjC,MAAIC,OAAO,IAAIP,WAAWQ,YAAf,EAAX;AACAD,OAAKE,cAAL,GAAsB,IAAtB;AACAF,OAAKG,KAAL,CAAWN,GAAX,EAAgB,CAACO,GAAD,EAAMC,MAAN,EAAcC,KAAd,KAAwB;AACtC,QAAIF,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAO;AADmB,OAArB,CAAP;AAGD;AACD,QAAIC,OAAO,IAAIrB,IAAJ,CAASgB,MAAT,CAAX;AACAK,SAAKC,QAAL,GAAgBd,IAAIe,OAApB;AACAF,SAAKG,QAAL,GAAcC,OAAOjB,IAAIe,OAAJ,CAAYG,IAAnB,CAAd;AACA,QAAIT,MAAMU,KAAV,EAAiB;AACfN,WAAKM,KAAL,CAAWC,IAAX,GAAkBzB,GAAG0B,YAAH,CAAgBZ,MAAMU,KAAN,CAAYG,IAA5B,CAAlB;AACAT,WAAKM,KAAL,CAAWI,WAAX,GAAyBd,MAAMU,KAAN,CAAYK,IAArC;AACAX,WAAKY,QAAL,GAAc,CAAd;AACD,KAJD,MAMEZ,KAAKY,QAAL,GAAc,CAAd;AACFZ,SAAKa,IAAL,CAAU,CAACnB,GAAD,EAAMoB,MAAN,KAAiB;AACzB,UAAIpB,GAAJ,EAAS;AACP,eAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,iBAAOL;AADmB,SAArB,CAAP;AAGD;AACDqB,kBAAY5B,IAAIe,OAAJ,CAAYc,GAAxB,EAA6B,CAA7B;AACA5B,UAAIU,IAAJ,CAASgB,MAAT;AACD,KARD;AASD,GAzBD;AA0BD,CA7BD;;AA+BA,MAAMG,WAAW,CAAC9B,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAiB6B,EAAjB,KAAwB;AACvCvC,OAAKwC,QAAL,CAAcD,EAAd,EACGE,QADH,CACY,UADZ,EACwB,UADxB,EACoCA,QADpC,CAC6C,OAD7C,EACsDA,QADtD,CAC+D,gBAD/D,EACiFA,QADjF,CAC0F,8BAD1F,EAEGC,IAFH,CAEQ,CAAC3B,GAAD,EAAMM,IAAN,KAAe;AACnB,QAAIN,OAAO,CAACM,IAAZ,EACE,OAAOZ,IAAIS,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BC,aAAO;AADqB,KAAvB,CAAP;AAGFZ,QAAIa,IAAJ,GAAWA,IAAX;AACAX;AACD,GATH;AAUD,CAXD;;AAaA,MAAMiC,aAAa,CAACnC,GAAD,EAAMC,GAAN,KAAc;AAC/BT,OAAK4C,IAAL,CAAU,EAAEtB,UAAUd,IAAIe,OAAJ,CAAYc,GAAxB,EAAV,EACGI,QADH,CACY,UADZ,EACwB,cADxB,EAEGA,QAFH,CAEY,mBAFZ,EAEiC,UAFjC,EAE6CA,QAF7C,CAEsD,gBAFtD,EAEwEA,QAFxE,CAEiF,8BAFjF,EAEiHA,QAFjH,CAE0H,OAF1H,EAGGA,QAHH,CAGY,UAHZ,EAGwB,UAHxB,EAIGI,IAJH,CAIQ,UAJR,EAKGH,IALH,CAKQ,CAAC3B,GAAD,EAAM+B,KAAN,KAAgB;AACpB,QAAI/B,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAAS2B,KAAT;AACD,GAZH;AAaD,CAdD;;AAgBA,MAAMC,eAAe,CAACvC,GAAD,EAAMC,GAAN,KAAc;AACjC,MAAIuC,YAAYxC,IAAIe,OAAJ,CAAYyB,SAA5B;AACAA,YAAUC,IAAV,CAAezC,IAAIe,OAAJ,CAAYc,GAA3B;AACArC,OAAK4C,IAAL,CAAU,EAAEtB,UAAU,EAAE4B,KAAK1C,IAAIe,OAAJ,CAAYyB,SAAnB,EAAZ,EAAV,EACGP,QADH,CACY,UADZ,EACwB,cADxB,EACwCA,QADxC,CACiD,OADjD,EAEGA,QAFH,CAEY,mBAFZ,EAEiC,UAFjC,EAE6CA,QAF7C,CAEsD,gBAFtD,EAEwEA,QAFxE,CAEiF,8BAFjF,EAGGA,QAHH,CAGY,UAHZ,EAGwB,UAHxB,EAIGI,IAJH,CAIQ,UAJR,EAKGH,IALH,CAKQ,CAAC3B,GAAD,EAAM+B,KAAN,KAAgB;AACpB,QAAI/B,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAAS2B,KAAT;AACD,GAZH;AAaD,CAhBD;;AAkBA,MAAMK,SAAS,CAAC3C,GAAD,EAAMC,GAAN,KAAc;AAC3B,MAAIY,OAAOb,IAAIa,IAAf;AACAA,OAAK8B,MAAL,CAAY,CAACpC,GAAD,EAAMqC,WAAN,KAAsB;AAChC,QAAIrC,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASiC,WAAT;AACD,GAPD;AAQD,CAVD;;AAYA,MAAMzB,QAAQ,CAACnB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAChCD,MAAI4C,GAAJ,CAAQ,cAAR,EAAwB7C,IAAIa,IAAJ,CAASM,KAAT,CAAeI,WAAvC;AACA,SAAOtB,IAAI6C,IAAJ,CAAS9C,IAAIa,IAAJ,CAASM,KAAT,CAAeC,IAAxB,CAAP;AACD,CAHD;;AAKA,MAAM2B,OAAO,CAAC/C,GAAD,EAAMC,GAAN,KAAc;AACzBT,OAAKwD,iBAAL,CACEhD,IAAIiD,IAAJ,CAASC,MADX,EAEE,EAAEC,OAAO,EAAEC,OAAOpD,IAAIiD,IAAJ,CAASI,MAAlB,EAAT,EAFF,EAGE,EAAEC,KAAK,IAAP,EAHF,EAIEpB,IAJF,CAIO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAXD;AAYD,CAbD;;AAeA,MAAM4B,SAAS,CAACvD,GAAD,EAAMC,GAAN,KAAc;AAC3BT,OAAKwD,iBAAL,CACEhD,IAAIiD,IAAJ,CAASC,MADX,EAEE,EAAEM,OAAO,EAAEJ,OAAOpD,IAAIiD,IAAJ,CAASI,MAAlB,EAAT,EAFF,EAGE,EAAEC,KAAK,IAAP,EAHF,EAIEpB,IAJF,CAIO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAXD;AAYD,CAbD;;AAeA,MAAM8B,eAAe,CAACzD,GAAD,EAAMC,GAAN,KAAc;;AAEjCT,OAAKkE,gBAAL,CACE;AACE7B,SAAK7B,IAAIiD,IAAJ,CAASC,MADhB;AAEE,qBAAiBlD,IAAIiD,IAAJ,CAASU,OAF5B;AAGE,yBAAqB3D,IAAIiD,IAAJ,CAASnC;AAHhC,GADF,EAME,EAAEqC,OAAO,EAAE,oBAAoBnD,IAAIiD,IAAJ,CAASI,MAA/B,EAAT,EANF,EAOEnB,IAPF,CAOO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAdD;AAeD,CAjBD;;AAmBA,MAAMiC,iBAAe,CAAC5D,GAAD,EAAKC,GAAL,KAAW;AAC9BT,OAAKkE,gBAAL,CACE;AACE7B,SAAK7B,IAAIiD,IAAJ,CAASC,MADhB;AAEE,qBAAiBlD,IAAIiD,IAAJ,CAASU,OAF5B;AAGE,yBAAqB3D,IAAIiD,IAAJ,CAASnC;AAHhC,GADF,EAME,EAAE0C,OAAO,EAAE,oBAAoBxD,IAAIiD,IAAJ,CAASI,MAA/B,EAAT,EANF,EAOEnB,IAPF,CAOO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAdD;AAeD,CAhBD;;AAkBA,MAAMkC,mBAAmB,CAAC7D,GAAD,EAAMC,GAAN,KAAc;AACrC,MAAI6D,UAAU;AACZC,UAAM/D,IAAIiD,IAAJ,CAASe,OADH;AAEZlD,cAAUd,IAAIiD,IAAJ,CAASI;;AAFP,GAAd;AAKA7D,OAAKkE,gBAAL,CACE,EAAE7B,KAAK7B,IAAIiD,IAAJ,CAASC,MAAhB,EAAwB,iBAAiBlD,IAAIiD,IAAJ,CAASU,OAAlD,EADF,EAEE,EAAER,OAAO,EAAE,yBAAyBW,OAA3B,EAAT,EAFF,EAGE,EAAER,KAAK,IAAP,EAHF,EAIEpB,IAJF,CAIO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDqB,gBAAY5B,IAAIiD,IAAJ,CAASI,MAArB,EAA6B,CAA7B;AACApD,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAZD;AAaD,CAnBD;AAoBA,MAAMsC,qBAAqB,CAACjE,GAAD,EAAMC,GAAN,KAAc;AACvC,MAAI6D,UAAU;AACZC,UAAM/D,IAAIiD,IAAJ,CAASe,OADH;AAEZlD,cAAUd,IAAIiD,IAAJ,CAASI;;AAFP,GAAd;AAKA7D,OAAKkE,gBAAL,CACE,EAAE7B,KAAK7B,IAAIiD,IAAJ,CAASC,MAAhB,EAAwB,iBAAiBlD,IAAIiD,IAAJ,CAASU,OAAlD,EADF,EAEE,EAAEH,OAAO,EAAE,yBAAyBM,OAA3B,EAAT,EAFF,EAGE,EAAER,KAAK,IAAP,EAHF,EAIEpB,IAJF,CAIO,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACtB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDqB,gBAAY5B,IAAIiD,IAAJ,CAASI,MAArB,EAA6B,CAA7B;AACApD,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAZD;AAaD,CAnBD;;AAqBA,MAAMgC,UAAU,CAAC3D,GAAD,EAAMC,GAAN,KAAc;AAC5B,MAAIiE,WAAW;AACbH,UAAM/D,IAAIiD,IAAJ,CAASU,OADF;AAEb7C,cAAUd,IAAIiD,IAAJ,CAASI,MAFN;AAGbD,WAAM;;AAHO,GAAf;;AAQA5D,OAAKwD,iBAAL,CACEhD,IAAIiD,IAAJ,CAASC,MADX,EAEE,EAAEC,OAAO,EAAEgB,UAAUD,QAAZ,EAAT,EAFF,EAGE,EAAEZ,KAAK,IAAP,EAHF,EAKGrB,QALH,CAKY,mBALZ,EAMGA,QANH,CAMY,UANZ,EAOGC,IAPH,CAOQ,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACrB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;;AAEDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAfH;AAgBD,CAzBD;AA0BA,MAAMyC,YAAY,CAACpE,GAAD,EAAMC,GAAN,KAAc;AAC9B,MAAI0D,UAAU3D,IAAIiD,IAAJ,CAASU,OAAvB;AACAnE,OAAKwD,iBAAL,CACEhD,IAAIiD,IAAJ,CAASC,MADX,EAEE,EAAEM,OAAO,EAAEW,UAAU,EAAEtC,KAAK8B,QAAQ9B,GAAf,EAAZ,EAAT,EAFF,EAGE,EAAEyB,KAAK,IAAP,EAHF,EAKGrB,QALH,CAKY,mBALZ,EAKiC,UALjC,EAMGA,QANH,CAMY,UANZ,EAMwB,UANxB,EAOGC,IAPH,CAOQ,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACrB,QAAIpB,GAAJ,EAAS;AACP,aAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAOL;AADmB,OAArB,CAAP;AAGD;AACDN,QAAIU,IAAJ,CAASgB,MAAT;AACD,GAdH;AAeD,CAjBD;;AAmBA,MAAM0C,WAAW,CAACrE,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACnC,MAAImE,WAAYpD,OAAOjB,IAAIsE,IAAJ,CAASzC,GAAhB,MAAyBZ,OAAOjB,IAAIa,IAAJ,CAASC,QAAT,CAAkBe,GAAzB,CAAzC;AACA,MAAI0C,gBAAcvE,IAAIsE,IAAJ,CAASE,IAAT,IAAe,OAAjC;AACA,MAAIH,YAAUE,aAAd,EAA6B;AAC5BrE;AACA,GAFD,MAIA;AACA,WAAOD,IAAIS,MAAJ,CAAW,KAAX,EAAkBC,IAAlB,CAAuB;AAC5BC,aAAO;AADqB,KAAvB,CAAP;AAGD;AACA,CAZD;;AAcA,MAAMgB,cAAc,CAACyB,MAAD,EAASoB,MAAT,KAAoB;AACtC/E,OAAKgE,gBAAL,CAAsB,EAAE7B,KAAKwB,MAAP,EAAtB,EAAuC,EAAEqB,MAAM,EAAEC,OAAOF,MAAT,EAAR,EAAvC,EAAoEvC,IAApE,CACE,CAAC3B,GAAD,EAAMoB,MAAN,KAAiB;AACf,QAAIpB,GAAJ,EAAS;AACP,aAAOA,GAAP;AACD;AACF,GALH;AAOD,CARD;;AAUA,MAAMqE,gBAAgB,CAAC5E,GAAD,EAAMC,GAAN,KAAc;AAClCT,OAAK4C,IAAL,CAAU,EAAV,EAAc,UAAU7B,GAAV,EAAesE,IAAf,EAAqB;AACjC,QAAGA,KAAKC,MAAL,IAAa,CAAhB,EACG7E,IAAI6C,IAAJ,CAAS,UAAT;AACH+B,SAAKE,OAAL,CAAa,UAAU3D,IAAV,EAAgB;AAC3B,UAAIW,KAAGX,KAAKW,EAAZ;AACA,UAAIqB,QAAQhC,KAAKgC,KAAL,CAAW0B,MAAvB;;AAGA,UAAIX,WAAW/C,KAAK+C,QAAL,CAAcW,MAA7B;AACA,YAAME,QAAQ,IAAIC,IAAJ,EAAd;AACA,YAAMC,WAAWC,KAAKC,GAAL,CAASJ,QAAQ5D,KAAKiE,OAAtB,CAAjB;AACA,YAAMC,WAAWH,KAAKI,IAAL,CAAUL,YAAY,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAA7B,CAAV,CAAjB;AACA1F,WAAKwD,iBAAL,CACEjB,EADF,EAEE,EAACyD,MAAK,EAACb,OAAQvB,QAAMe,QAAP,GAAiBmB,QAAzB,EAAN,EAFF,EAGE,UAAUG,IAAV,EAAgBC,GAAhB,EAAqB;AACnB,YAAID,IAAJ,EAAU;AACRE,kBAAQC,GAAR,CAAYrF,GAAZ;AACD;AACF,OAPH;AAYD,KArBD;AAsBD,GAzBD,EAyBG2B,IAzBH,CAyBQ,CAAC3B,GAAD,EAAM+B,KAAN,KAAgB;AACtB,QAAI/B,GAAJ,EAAS;AACPoF,cAAQC,GAAR,CAAYrF,GAAZ;AACD;AAIF,GAhCD;AAiCA,MAAIsF,SAAS,EAAElB,OAAO,CAAC,CAAV,EAAb;AACInF,OAAK4C,IAAL,CAAU,EAAV,EAAcH,QAAd,CAAuB,UAAvB,EAAmCA,QAAnC,CAA4C,mBAA5C,EAAiEA,QAAjE,CAA0E,8BAA1E,EAA0GA,QAA1G,CAAmH,gBAAnH,EAAqII,IAArI,CAA0IwD,MAA1I,EAAkJ3D,IAAlJ,CAAuJ,CAAC4D,EAAD,EAAInE,MAAJ,KAAa;AAClK,QAAImE,EAAJ,EAAQ7F,IAAIU,IAAJ,CAASmF,EAAT,EAAR,KAEE7F,IAAIU,IAAJ,CAASgB,MAAT;AACH,GAJD;AAKL,CAxCD;;AA0CAoE,OAAOC,OAAP,GAAiB;AACf7D,YADe;AAEfI,cAFe;AAGfxC,QAHe;AAIf+B,UAJe;AAKfa,QALe;AAMfxB,OANe;AAOf4B,MAPe;AAQfQ,QARe;AASfI,SATe;AAUfS,WAVe;AAWfC,UAXe;AAYfZ,cAZe;AAafI,kBAbe;AAcfe,eAde;AAefhB,gBAfe;AAgBfK;AAhBe,CAAjB","file":"postControllers.js","sourceRoot":"E:/Sublime Text 2/Codes/OpenForum-Project/controllers","sourcesContent":["const Post = require(\"../models/post\");\r\nconst User = require(\"../models/user\");\r\nconst fs = require(\"fs\");\r\nconst formidable = require(\"formidable\");\r\nconst session = require(\"express-session\");\r\nconst passport = require(\"passport\");\r\n\r\nconst create = (req, res, next) => {\r\n  let form = new formidable.IncomingForm();\r\n  form.keepExtensions = true;\r\n  form.parse(req, (err, fields, files) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: \"Image could not be uploaded\",\r\n      });\r\n    }\r\n    let post = new Post(fields);\r\n    post.postedBy = req.profile;\r\n    post.username=String(req.profile.name)\r\n    if (files.photo) {\r\n      post.photo.data = fs.readFileSync(files.photo.path);\r\n      post.photo.contentType = files.photo.type;\r\n      post.hasphoto=1\r\n    }\r\n    else\r\n      post.hasphoto=0\r\n    post.save((err, result) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: err,\r\n        });\r\n      }\r\n      updateScore(req.profile._id, 2);\r\n      res.json(result);\r\n    });\r\n  });\r\n};\r\n\r\nconst postByID = (req, res, next, id) => {\r\n  Post.findById(id)\r\n    .populate(\"postedBy\", \"_id name\").populate(\"likes\").populate(\"comments.likes\").populate(\"comments.incomments.postedBy\")\r\n    .exec((err, post) => {\r\n      if (err || !post)\r\n        return res.status(\"400\").json({\r\n          error: \"Post not found\",\r\n        });\r\n      req.post = post;\r\n      next();\r\n    });\r\n};\r\n\r\nconst listByUser = (req, res) => {\r\n  Post.find({ postedBy: req.profile._id })\r\n    .populate(\"comments\", \"text created\")\r\n    .populate(\"comments.postedBy\", \"_id name\").populate(\"comments.likes\").populate(\"comments.incomments.postedBy\").populate(\"likes\")\r\n    .populate(\"postedBy\", \"_id name\")\r\n    .sort(\"-created\")\r\n    .exec((err, posts) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: err,\r\n        });\r\n      }\r\n      res.json(posts);\r\n    });\r\n};\r\n\r\nconst listNewsFeed = (req, res) => {\r\n  let following = req.profile.following;\r\n  following.push(req.profile._id);\r\n  Post.find({ postedBy: { $in: req.profile.following } })\r\n    .populate(\"comments\", \"text created\").populate(\"likes\")\r\n    .populate(\"comments.postedBy\", \"_id name\").populate(\"comments.likes\").populate(\"comments.incomments.postedBy\")\r\n    .populate(\"postedBy\", \"_id name\")\r\n    .sort(\"-created\")\r\n    .exec((err, posts) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: err,\r\n        });\r\n      }\r\n      res.json(posts);\r\n    });\r\n};\r\n\r\nconst remove = (req, res) => {\r\n  let post = req.post;\r\n  post.remove((err, deletedPost) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    res.json(deletedPost);\r\n  });\r\n};\r\n\r\nconst photo = (req, res, next) => {\r\n  res.set(\"Content-Type\", req.post.photo.contentType);\r\n  return res.send(req.post.photo.data);\r\n};\r\n\r\nconst like = (req, res) => {\r\n  Post.findByIdAndUpdate(\r\n    req.body.postId,\r\n    { $push: { likes: req.body.userId } },\r\n    { new: true }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    res.json(result);\r\n  });\r\n};\r\n\r\nconst unlike = (req, res) => {\r\n  Post.findByIdAndUpdate(\r\n    req.body.postId,\r\n    { $pull: { likes: req.body.userId } },\r\n    { new: true }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    res.json(result);\r\n  });\r\n};\r\n\r\nconst likeacomment = (req, res) => {\r\n  \r\n  Post.findOneAndUpdate(\r\n    {\r\n      _id: req.body.postId,\r\n      \"comments.text\": req.body.comment,\r\n      \"comments.postedBy\": req.body.postedBy,\r\n    },\r\n    { $push: { \"comments.$.likes\": req.body.userId } }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    res.json(result);\r\n  });\r\n};\r\n\r\nconst unlikeacomment=(req,res)=>{\r\n  Post.findOneAndUpdate(\r\n    {\r\n      _id: req.body.postId,\r\n      \"comments.text\": req.body.comment,\r\n      \"comments.postedBy\": req.body.postedBy,\r\n    },\r\n    { $pull: { \"comments.$.likes\": req.body.userId } }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    res.json(result);\r\n  });\r\n}\r\n\r\nconst commentincomment = (req, res) => {\r\n  var changes = {\r\n    text: req.body.comtext,\r\n    postedBy: req.body.userId,\r\n    \r\n  };\r\n  Post.findOneAndUpdate(\r\n    { _id: req.body.postId, \"comments.text\": req.body.comment },\r\n    { $push: { \"comments.$.incomments\": changes } },\r\n    { new: true }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    updateScore(req.body.userId, 1);\r\n    res.json(result);\r\n  });\r\n};\r\nconst uncommentincomment = (req, res) => {\r\n  var changes = {\r\n    text: req.body.comtext,\r\n    postedBy: req.body.userId,\r\n    \r\n  };\r\n  Post.findOneAndUpdate(\r\n    { _id: req.body.postId, \"comments.text\": req.body.comment },\r\n    { $pull: { \"comments.$.incomments\": changes } },\r\n    { new: true }\r\n  ).exec((err, result) => {\r\n    if (err) {\r\n      return res.status(400).json({\r\n        error: err,\r\n      });\r\n    }\r\n    updateScore(req.body.userId, 1);\r\n    res.json(result);\r\n  });\r\n};\r\n\r\nconst comment = (req, res) => {\r\n  var commentf = {\r\n    text: req.body.comment,\r\n    postedBy: req.body.userId,\r\n    likes:[]\r\n  \r\n    \r\n  };\r\n\r\n  Post.findByIdAndUpdate(\r\n    req.body.postId,\r\n    { $push: { comments: commentf } },\r\n    { new: true }\r\n  )\r\n    .populate(\"comments.postedBy\")\r\n    .populate(\"postedBy\")\r\n    .exec((err, result) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: err,\r\n        });\r\n      }\r\n      \r\n      res.json(result);\r\n    });\r\n};\r\nconst uncomment = (req, res) => {\r\n  let comment = req.body.comment;\r\n  Post.findByIdAndUpdate(\r\n    req.body.postId,\r\n    { $pull: { comments: { _id: comment._id } } },\r\n    { new: true }\r\n  )\r\n    .populate(\"comments.postedBy\", \"_id name\")\r\n    .populate(\"postedBy\", \"_id name\")\r\n    .exec((err, result) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          error: err,\r\n        });\r\n      }\r\n      res.json(result);\r\n    });\r\n};\r\n\r\nconst isPoster = (req, res, next) => {\r\n  let isPoster = (String(req.user._id) === String(req.post.postedBy._id));\r\n  let isPosteradmin=req.user.role==\"Admin\"\r\n  if (isPoster||isPosteradmin) {\r\n   next()\r\n  }\r\n  else\r\n  {\r\n  return res.status(\"403\").json({\r\n    error: \"User is not authorized! login now\",\r\n  });\r\n}\r\n};\r\n\r\nconst updateScore = (userId, points) => {\r\n  User.findOneAndUpdate({ _id: userId }, { $mul: { score: points } }).exec(\r\n    (err, result) => {\r\n      if (err) {\r\n        return err;\r\n      }\r\n    }\r\n  );\r\n};\r\n\r\nconst trendingposts = (req, res) => {\r\n  Post.find({}, function (err, docs) {\r\n    if(docs.length==0)\r\n       res.send(\"No posts\")\r\n    docs.forEach(function (data) {\r\n      var id=data.id\r\n      var likes = data.likes.length;\r\n    \r\n    \r\n      var comments = data.comments.length;\r\n      const date2 = new Date();\r\n      const diffTime = Math.abs(date2 - data.created);\r\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n      Post.findByIdAndUpdate(\r\n        id,\r\n        {$inc:{score: (likes*comments)/diffDays} },\r\n        function (errr, doc) {\r\n          if (errr) {\r\n            console.log(err);\r\n          }\r\n        }\r\n      );\r\n      \r\n      \r\n    \r\n    });\r\n  }).exec((err, posts) => {\r\n    if (err) {\r\n      console.log(err)\r\n    }\r\n   \r\n   \r\n\r\n  });\r\n  var mysort = { score: -1 };\r\n      Post.find({}).populate('postedBy').populate('comments.postedBy').populate('comments.incomments.postedBy').populate(\"comments.likes\").sort(mysort).exec((er,result)=>{\r\n        if (er) res.json(er)\r\n        else\r\n          res.json(result)\r\n      })\r\n};\r\n\r\nmodule.exports = {\r\n  listByUser,\r\n  listNewsFeed,\r\n  create,\r\n  postByID,\r\n  remove,\r\n  photo,\r\n  like,\r\n  unlike,\r\n  comment,\r\n  uncomment,\r\n  isPoster,\r\n  likeacomment,\r\n  commentincomment,\r\n  trendingposts,\r\n  unlikeacomment,\r\n  uncommentincomment\r\n};\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4500c66f4c11590a3c48dcff81749dcc133b7faf","contentHash":"030d6e3a0c688eaad253d7faa60554c88ed62597ebffac45e78f78b83a933fa8"}}